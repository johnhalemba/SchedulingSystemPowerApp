Screen1 As screen:
    Fill: =RGBA(224, 224, 224, 1)
    OnVisible: |
        =Set(DurationSelection, Blank());
        UpdateContext({ResetTrue: false});
        UpdateContext({ResetTrue: true});

    ContainerFooter As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.Regular
        Height: =100
        RadiusBottomLeft: =10
        RadiusBottomRight: =10
        RadiusTopLeft: =10
        RadiusTopRight: =10
        Width: =Parent.Width - (20 * 2)
        X: =20
        Y: =42+19+ContainerMainBody.Height+10
        ZIndex: =1

        Button3_2 As button:
            DisabledFill: |-
                =ColorValue("#FFFFFF")
            DisplayMode: =DisplayMode.Disabled
            Height: =Parent.Height
            Text: =""
            Width: =Parent.Width
            ZIndex: =1

        TextInput1 As text:
            Align: =Align.Center
            Default: ="Jan Halemba (305979)"
            DisabledFill: |-
                =ColorValue("#FFFFFF")
            DisplayMode: =DisplayMode.Disabled
            Height: =20
            Size: =9
            Width: =Parent.Width
            ZIndex: =2

    ContainerMainBody As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.Regular
        Height: =Parent.Height - 90
        RadiusBottomLeft: =10
        RadiusBottomRight: =10
        RadiusTopLeft: =10
        RadiusTopRight: =10
        Visible: =!varRoomSelection && !varViewSchedule
        Width: =Parent.Width - (20 * 2)
        X: =20
        Y: =60
        ZIndex: =2

        Background As button:
            DisplayMode: =DisplayMode.Disabled
            Height: =Parent.Height
            Text: =""
            Width: =Parent.Width
            ZIndex: =1

        Label1 As label:
            FontWeight: =FontWeight.Bold
            Height: =60
            Size: =25
            Text: ="Welcome, "&Left(User().FullName, Find(" ",User().FullName) - 1)&"!"
            Width: =581
            X: =30
            Y: =20
            ZIndex: =2

        Button2_1 As button:
            BorderThickness: =0
            Height: =251
            OnSelect: |-
                =Set(ShowLoading, true);
                UpdateContext({varViewSchedule: true});
                If( Mod(Minute(Now()), 30) <= 14,
                    Set(StartDateTime, DateAdd(Now(), -Mod(Minute(Now()), 30), TimeUnit.Minutes));
                    Set(EndDateTime, DateAdd(StartDateTime, 30, TimeUnit.Minutes)),
                    Mod(Minute(Now()), 30) > 15,
                    Set(StartDateTime, DateAdd(Now(), -Mod(Minute(Now()), 30), TimeUnit.Minutes));
                    Set(EndDateTime, DateAdd(StartDateTime, 30, TimeUnit.Minutes)),
                    Set(StartDateTime, Now());
                    Set(EndDateTime, DateAdd(Now(), -Mod(Minute(Now()), 30) + 60, TimeUnit.Minutes))
                );
                Concurrent(
                    ClearCollect(ScheduleRoom102, 'Serwer Studia'.Getclassesfromroom("1030-ETI-102", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom103, 'Serwer Studia'.Getclassesfromroom("1030-ETI-103", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom104, 'Serwer Studia'.Getclassesfromroom("1030-ETI-104", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom105, 'Serwer Studia'.Getclassesfromroom("1030-ETI-105-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Concurrent(
                    ClearCollect(ScheduleRoom106, 'Serwer Studia'.Getclassesfromroom("1030-ETI-106", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom107, 'Serwer Studia'.Getclassesfromroom("1030-ETI-107", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom161, 'Serwer Studia'.Getclassesfromroom("1030-ETI-161", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom108, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Concurrent(
                    ClearCollect(ScheduleRoom116, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom117, 'Serwer Studia'.Getclassesfromroom("1030-ETI-117", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom116AR, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom133, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Concurrent(
                    ClearCollect(ScheduleRoom120, 'Serwer Studia'.Getclassesfromroom("1030-ETI-120", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom121, 'Serwer Studia'.Getclassesfromroom("1030-ETI-121", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom122, 'Serwer Studia'.Getclassesfromroom("1030-ETI-122", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                Set(ShowLoading, false);
            Text: ="Check schedule"
            Width: =335
            X: =30
            Y: =393
            ZIndex: =4

        DropdownCalendarType As dropdown:
            AllowEmptySelection: =true
            Default: =""
            Items: =["Serwer Studia", "Outlook"]
            OnChange: |-
                =If (
                    Self.Selected.Value = "Serwer Studia",
                    UpdateContext({serwerStudia: true}),
                    UpdateContext({serwerStudia: false})
                )
            Tooltip: ="Select calendar..."
            Width: =200
            X: =463
            Y: =78
            ZIndex: =6

        MakeReservationButton_old As button:
            BorderThickness: =0
            Height: =236
            OnSelect: |
                =Set(ShowLoading, true);
                UpdateContext({varRoomSelection: true});
                Set(DateSelected, Today());
                Set(DateTimeRoomChange, true);
                If( Mod(Minute(Now()), 30) <= 14,
                    Set(StartDateTime, DateAdd(Now(), -Mod(Minute(Now()), 30), TimeUnit.Minutes));
                    Set(EndDateTime, DateAdd(StartDateTime, 30, TimeUnit.Minutes)),
                    Mod(Minute(Now()), 30) > 15,
                    Set(StartDateTime, DateAdd(Now(), -Mod(Minute(Now()), 30), TimeUnit.Minutes));
                    Set(EndDateTime, DateAdd(StartDateTime, 30, TimeUnit.Minutes)),
                    Set(StartDateTime, Now());
                    Set(EndDateTime, DateAdd(Now(), -Mod(Minute(Now()), 30) + 60, TimeUnit.Minutes))
                );
                Concurrent(
                    ClearCollect(ScheduleRoom102, 'Serwer Studia'.Getclassesfromroom("1030-ETI-102", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom103, 'Serwer Studia'.Getclassesfromroom("1030-ETI-103", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom104, 'Serwer Studia'.Getclassesfromroom("1030-ETI-104", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom105, 'Serwer Studia'.Getclassesfromroom("1030-ETI-105-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Concurrent(
                    ClearCollect(ScheduleRoom106, 'Serwer Studia'.Getclassesfromroom("1030-ETI-106", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom107, 'Serwer Studia'.Getclassesfromroom("1030-ETI-107", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom161, 'Serwer Studia'.Getclassesfromroom("1030-ETI-161", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom108, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Concurrent(
                    ClearCollect(ScheduleRoom116, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom117, 'Serwer Studia'.Getclassesfromroom("1030-ETI-117", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom116AR, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom133, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Concurrent(
                    ClearCollect(ScheduleRoom120, 'Serwer Studia'.Getclassesfromroom("1030-ETI-120", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom121, 'Serwer Studia'.Getclassesfromroom("1030-ETI-121", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom122, 'Serwer Studia'.Getclassesfromroom("1030-ETI-122", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                Set(ShowLoading, false);
            Text: ="Make a reservation"
            Width: =335
            X: =30
            Y: =121
            ZIndex: =7

        "Gallery2_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            DisplayMode: =DisplayMode.View
            Height: =557
            Items: =Sort(Filter('Serwer Studia'.Getuserschedule("json", Text(DatePicker1_1.SelectedDate, "yyyy-mm-dd")).plan, DateValue(date) = DatePicker1_1.SelectedDate),hour)
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            Selectable: =false
            TemplatePadding: =0
            TemplateSize: =105
            Transition: =Transition.Push
            Visible: =serwerStudia
            Width: =(Parent.Width - 20)/2 - 20
            X: =Parent.Width / 2
            Y: =121
            ZIndex: =8

            Button1_1 As button:
                DisabledFill: =RGBA(244, 244, 244, 0.2)
                DisplayMode: =DisplayMode.Disabled
                Height: =Parent.TemplateHeight - 16
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =60
                RadiusBottomRight: =60
                RadiusTopLeft: =60
                RadiusTopRight: =60
                Text: =""
                Width: =Parent.TemplateWidth - 16
                X: =8
                Y: =8
                ZIndex: =1

            ClassNameGalleryServerStudia As label:
                FontWeight: =FontWeight.Semibold
                Height: =89
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =30
                Text: =Last(Split(ThisItem.skr, "-")).Value
                Width: =128
                X: =40
                Y: =10
                ZIndex: =2

            Subtitle2_3 As label:
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =23
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =
                VerticalAlign: =VerticalAlign.Top
                Width: =45
                X: =504
                Y: =40
                ZIndex: =3

            ClassTypeGalleryServerStudia As label:
                Align: =Align.Center
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =89
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =20
                Text: =ThisItem.type
                Width: =56
                X: =173
                Y: =8
                ZIndex: =6

            Group1 As group:
                Height: =5
                Width: =5
                X: =60
                Y: =60
                ZIndex: =9

                Subtitle2_4 As label:
                    Align: =Align.Center
                    AutoHeight: =true
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =44
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =20
                    Text: |-
                        =DateAdd(TimeValue(ThisItem.hour&":00"),15,TimeUnit.Minutes)&" - "&DateAdd(TimeValue(ThisItem.hour&":00"),ThisItem.length,TimeUnit.Hours)
                    Width: =396
                    X: =229
                    Y: =Parent.TemplateHeight - Parent.TemplateHeight + 20
                    ZIndex: =7

                Subtitle2_5 As label:
                    Align: =Align.Center
                    AutoHeight: =true
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =45
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =20
                    Text: |-
                        ="sala: "
                        &
                        If (
                            EndsWith(Last(Split(ThisItem.room,"-")).Value, "AR"),
                            Last(FirstN(Split(ThisItem.room,"-"), CountRows(Split(ThisItem.room,"-")) - 1)).Value & "-" & Last(Split(ThisItem.room,"-")).Value,
                            Last(Split(ThisItem.room,"-")).Value
                        )
                    Width: =396
                    X: =229
                    Y: =Subtitle2_4.Y + Self.Height + 2
                    ZIndex: =8

        "Gallery2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            DisplayMode: =DisplayMode.View
            Height: =562
            Items: =Sort(Filter(Office365Outlook.V4CalendarGetItems(Dropdown1.Selected.id).value, DateValue(startWithTimeZone)=DateValue(varShowDate)),TimeValue(startWithTimeZone))
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            Selectable: =false
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =105
            Transition: =Transition.Push
            Visible: =!serwerStudia
            Width: =(Parent.Width - 20)/2 - 20
            X: =683
            Y: =116
            ZIndex: =9

            Button1 As button:
                DisabledFill: =RGBA(244, 244, 244, 0.2)
                DisplayMode: =DisplayMode.Disabled
                Height: =Parent.TemplateHeight - 16
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =60
                RadiusBottomRight: =60
                RadiusTopLeft: =60
                RadiusTopRight: =60
                Text: =""
                Width: =Parent.TemplateWidth - 16
                X: =8
                Y: =8
                ZIndex: =1

            Title2 As label:
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =36
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =20
                Text: =ThisItem.subject
                VerticalAlign: =VerticalAlign.Top
                Width: =272
                X: =Parent.X - Parent.TemplateWidth + 40
                Y: =34
                ZIndex: =2

            Subtitle2 As label:
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =23
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =
                VerticalAlign: =VerticalAlign.Top
                Width: =45
                X: =494
                Y: =40
                ZIndex: =3

            NextArrow2 As icon.ChevronRight:
                AccessibleLabel: =Self.Tooltip
                Color: =RGBA(166, 166, 166, 1)
                Height: =50
                Icon: =Icon.ChevronRight
                OnSelect: =Select(Parent)
                PaddingBottom: =16
                PaddingLeft: =16
                PaddingRight: =16
                PaddingTop: =16
                Tooltip: ="View item details"
                Width: =50
                X: =Parent.TemplateWidth - Self.Width - 12
                Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                ZIndex: =4

            Subtitle2_1 As label:
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =36
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =24
                Text: |-
                    =Text(ThisItem.startWithTimeZone, "hh:mm")&" - "&Text(ThisItem.endWithTimeZone, "hh:mm")
                VerticalAlign: =VerticalAlign.Top
                Width: =206
                X: =372
                Y: =34
                ZIndex: =6

        Container1 As groupContainer:
            DropShadow: =DropShadow.None
            Height: =40
            Width: =255
            X: =872
            Y: =78
            ZIndex: =10

            Icon1 As icon.ArrowRight:
                Height: =40
                Icon: =Icon.ArrowRight
                OnSelect: |-
                    =(DatePicker1_1.SelectedDate);
                    Set(varShowDate, DateAdd(varShowDate, 1, TimeUnit.Days))
                Width: =31
                X: =215
                ZIndex: =1

            Icon2 As icon.ArrowLeft:
                Height: =40
                Icon: =Icon.ArrowLeft
                OnSelect: =Set(varShowDate, DateAdd(varShowDate, -1, TimeUnit.Days))
                Width: =31
                ZIndex: =2

            DatePicker1_1 As datepicker:
                BorderThickness: =0
                Color: =Background.DisabledFill
                DefaultDate: =
                DisabledFill: =Parent.Fill
                Fill: =Background.DisabledFill
                Height: =Parent.Height
                InputTextPlaceholder: =
                OnChange: =Set(varShowDate, DateValue(DatePicker1_1.SelectedDate))
                OnSelect: |-
                    =UpdateContext({plan:Filter('Serwer Studia'.Getuserschedule("json", Text(Self.SelectedDate, "yyyy-mm-dd")).plan, date = Text(Self.SelectedDate,"yyyymmdd"))})
                Width: =166
                X: =44
                ZIndex: =3

            Label2 As label:
                Align: =Align.Center
                AutoHeight: =true
                Size: =17
                Text: =Text(varShowDate, "dd/mm/yyyy")
                Width: =132
                X: =39
                ZIndex: =4

        LoadingScreen As group:
            Height: =5
            Width: =5
            X: =40
            Y: =60
            ZIndex: =14

            Rectangle2_1 As rectangle:
                BorderColor: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(255, 255, 255, 1)
                Height: =678
                Visible: =ShowLoading
                Width: =1326
                ZIndex: =11

            Spinner1_1 As Spinner:
                BasePaletteColor: =
                DisplayMode: =DisplayMode.Edit
                FontColor: =
                Height: =200
                Visible: =ShowLoading
                Width: =200
                X: =577
                Y: =217
                ZIndex: =12

            Label8_1 As label:
                Align: =Align.Center
                Text: ="Loading..."
                Visible: =ShowLoading
                Width: =442
                X: =456
                Y: =404
                ZIndex: =13

        Container3 As groupContainer.manualLayoutContainer:
            Height: =297
            Width: =391
            X: =423
            Y: =233
            ZIndex: =15

            btn_MakeReservation As button:
                Color: |-
                    =If(
                        btn_MakeReservation.Pressed,
                        WEITI_Szafirowy,
                        ColorFade(WEITI_Szafirowy, 20%),
                    )
                Fill: |-
                    =If(
                        btn_MakeReservation.Pressed,
                        ColorFade(WEITI_Szafirowy, 20%),
                        WEITI_Szafirowy
                    )
                Height: =Parent.Height - Self.BorderThickness
                Text: =""
                Width: =Parent.Width - Self.BorderThickness
                X: =2
                Y: =2
                ZIndex: =1

            btn_Overlay As button:
                BorderStyle: =BorderStyle.None
                Color: =Color.Transparent
                DisabledColor: =Color.Transparent
                DisabledFill: =Color.Transparent
                Fill: =Color.Transparent
                Height: =btn_MakeReservation.Height
                HoverColor: =Color.Transparent
                HoverFill: =RGBA(0, 0, 0, 0.05)
                PressedColor: =Color.Transparent
                PressedFill: =Color.Transparent
                Text: ="Button"
                Width: =btn_MakeReservation.Width
                X: =btn_MakeReservation.X
                Y: =btn_MakeReservation.Y
                ZIndex: =3

    Dropdown1 As dropdown:
        Items: =Office365Outlook.CalendarGetTablesV2().value
        Visible: =DropdownCalendarType.SelectedText.Value = "Outlook"
        X: =440
        Y: =205
        ZIndex: =6

    ContainerHeader As groupContainer:
        DropShadow: =DropShadow.Regular
        Height: =100
        RadiusBottomLeft: =10
        RadiusBottomRight: =10
        RadiusTopLeft: =10
        RadiusTopRight: =10
        Width: =Parent.Width - (20 * 2)
        X: =20
        Y: =-50
        ZIndex: =12

        Button3 As button:
            DisplayMode: =DisplayMode.Disabled
            Height: =Parent.Height
            Text: =""
            Width: =Parent.Width
            ZIndex: =1

        Header1 As Header:
            BasePaletteColor: =RGBA(224, 224, 224, 1)
            DisplayMode: =DisplayMode.Edit
            Font: =Font.Lato
            FontColor: =
            Height: =Parent.Height - 50
            IsProfilePictureVisible: =true
            IsTitleVisible: =true
            Logo: ='Screenshot 2024-03-02 184341'
            OnSelectLogo: =Navigate(Screen1, Transition.Pop)
            Style: ='Header.Style'.Neutral
            Title: ="FeiT Reservation System"
            UserEmail: =User().Email
            UserImage: =User().Image
            UserName: =User().FullName
            Visible: =false
            Width: =Parent.Width
            X: =0
            Y: =0
            ZIndex: =2

        Rectangle3 As rectangle:
            Fill: |-
                =ColorValue("#FFFFFF")
            Height: =50
            Width: =1326
            Y: =50
            ZIndex: =3

        BadgeCanvas1 As Badge:
            BasePaletteColor: =
            Content: =Left(User().FullName, 1) & Mid(User().FullName, Find(" ", User().FullName) + 1, 1)
            DisplayMode: =DisplayMode.Edit
            FontColor: =
            Height: =37
            Width: =37
            X: =Parent.Width - Self.Width - 13
            Y: =Parent.Height - Self.Height - (Rectangle3.Height / 2) + (Self.Height / 2)
            ZIndex: =4

        Label9 As label:
            Align: =Align.Right
            DisplayMode: =DisplayMode.View
            Text: =User().FullName
            Width: =383
            X: =883
            Y: =Parent.Height - Self.Height - (Rectangle3.Height / 2) + (Self.Height / 2)
            ZIndex: =5

        Image4 As image:
            Height: =37
            Image: ='Screenshot 2024-03-02 184341'
            Width: =37
            X: =22
            Y: =Parent.Height - Self.Height - (Rectangle3.Height / 2) + (Self.Height / 2)
            ZIndex: =6

        Label10 As label:
            Font: ="Adagio Slab"
            FontWeight: =FontWeight.Semibold
            Size: =15
            Text: ="FEIT Reservation System"
            Width: =459
            X: =70
            Y: =Parent.Height - Self.Height - (Rectangle3.Height / 2) + (Self.Height / 2)
            ZIndex: =7

    RoomSelectionPopup As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.Regular
        Height: =Parent.Height - 90
        RadiusBottomLeft: =10
        RadiusBottomRight: =10
        RadiusTopLeft: =10
        RadiusTopRight: =10
        Visible: =varRoomSelection
        Width: |-
            =If (ShowDatePicker || ShowTimePicker,
                Parent.Width * 2 / 3 - 45,
                Parent.Width - (20 * 2)
            )
        X: =20
        Y: =60
        ZIndex: =15

        Button3_3 As button:
            DisplayMode: =DisplayMode.Disabled
            Height: =Parent.Height
            Text: =""
            Width: =Parent.Width
            ZIndex: =1

        Icon3 As icon.Cancel:
            Height: =44
            Icon: =Icon.Cancel
            OnSelect: |-
                =Set(ShowLoading, true);
                If (!ShowDatePicker,
                    UpdateContext({varRoomSelection:false})
                );
                UpdateContext({SelectedRoom: Blank()});
                Set(ShowLoading, false)
            Visible: =!(ShowDatePicker || ShowTimePicker)
            Width: =44
            X: =Parent.Width - Self.Width - 10
            Y: =10
            ZIndex: =2

        Button2_5 As button:
            OnSelect: |
                =Set(firstDayOfMonth, DateAdd(DateSelected, 1 - Day(DateSelected), TimeUnit.Days));
                Set(firstDayInView, DateAdd(firstDayOfMonth, -(Mod(Weekday(firstDayOfMonth)-2,7)+1),TimeUnit.Days));
                Set(LastDayOfMonth, DateAdd(DateAdd(firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                UpdateContext({ResetDateStore: DateSelected});
                UpdateContext({ResetFirstDayOfMonth: DateAdd(DateSelected, 1 - Day(DateSelected), TimeUnit.Days)});
                Set(ShowDatePicker, true)
            Text: =If(DateDiff(Today(), StartDateTime, TimeUnit.Hours) < 24, "Today", Text(StartDateTime, "[$-en-US]mmmm dd, yyyy"))
            Width: =319
            X: =Parent.Width - Self.Width - 20
            Y: =130
            ZIndex: =3

        Button2_7 As button:
            OnSelect: |
                =Set(ShowTimePicker, true)
            Text: |+
                =Text(StartDateTime, DateTimeFormat.ShortTime) & " - " & Text(EndDateTime, DateTimeFormat.ShortTime)
                
            Width: =319
            X: =Parent.Width - Self.Width - 20
            Y: =197
            ZIndex: =4

        Container2 As groupContainer:
            Height: =Parent.Height - 20
            RadiusBottomLeft: =10
            RadiusBottomRight: =10
            RadiusTopLeft: =10
            RadiusTopRight: =10
            Width: =942
            X: =10
            Y: =10
            ZIndex: =5

            Image2 As image:
                Height: =Parent.Height
                Image: ='Screenshot 2024-03-17 at 22.21.45'
                ImagePosition: =ImagePosition.Stretch
                Width: =Parent.Width
                ZIndex: =1

            room103 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom103,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "103",
                        "X"
                    )
                Width: =32
                X: =109
                Y: =352
                ZIndex: =2

            room104 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom104,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "104",
                        "X"
                    )
                Width: =32
                X: =141
                Y: =352
                ZIndex: =3

            room102 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom102,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "102",
                        "X"
                    )
                Width: =34
                X: =75
                Y: =352
                ZIndex: =4

            room161 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom161,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =118
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "161",
                        "X"
                    )
                Width: =95
                X: =151
                Y: =176
                ZIndex: =11

            room107 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom107,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "107",
                        "X"
                    )
                Width: =33
                X: =260
                Y: =352
                ZIndex: =12

            room108 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom108,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "108",
                        "X"
                    )
                Width: =48
                X: =293
                Y: =352
                ZIndex: =13

            room106 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom106,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "106",
                        "X"
                    )
                Width: =34
                X: =226
                Y: =352
                ZIndex: =14

            room105 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom161,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =83
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "105",
                        "X"
                    )
                Width: =74
                X: =161
                Y: =415
                ZIndex: =15

            room116 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom116,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "116",
                        "X"
                    )
                Width: =48
                X: =560
                Y: =352
                ZIndex: =16

            room117 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom117,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "117",
                        "X"
                    )
                Width: =34
                X: =608
                Y: =352
                ZIndex: =17

            room133 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom133,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =118
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "133",
                        "X"
                    )
                Width: =95
                X: =622
                Y: =176
                ZIndex: =18

            "'room116-AR' As button":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom161,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =83
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "116-AR",
                        "X"
                    )
                Width: =74
                X: =632
                Y: =415
                ZIndex: =19

            room120 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom117,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "120",
                        "X"
                    )
                Width: =34
                X: =725
                Y: =352
                ZIndex: =20

            room121 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom117,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "121",
                        "X"
                    )
                Width: =34
                X: =759
                Y: =352
                ZIndex: =21

            room122 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If(
                        CountRows(
                            Filter(
                                ScheduleRoom117,
                                With(
                                    {
                                        classStart: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + 0.25,
                                            TimeUnit.Hours
                                        ),
                                        classEnd: DateAdd(
                                            DateValue(
                                                date,
                                                "en"
                                            ),
                                            hour + Value(length),
                                            TimeUnit.Hours
                                        )
                                    },
                                    Or(
                                        And(
                                            classStart <= EndDateTime,
                                            classStart >= StartDateTime
                                        ),
                                        And(
                                            classEnd <= EndDateTime,
                                            classEnd >= StartDateTime
                                        ),
                                        And(
                                            StartDateTime <= classEnd,
                                            StartDateTime >= classStart
                                        )
                                    )
                                )
                            )
                        ) = 0,
                        If (SelectedRoom = Self,
                            Color.Yellow,
                            Color.Green
                        ),
                        Color.Red
                    )
                FocusedBorderThickness: =1
                Height: =59
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "122",
                        "X"
                    )
                Width: =33
                X: =793
                Y: =332
                ZIndex: =22

        Label7 As label:
            Text: |-
                ="Selected room:"
            X: =987
            Y: =267
            ZIndex: =6

        Button2_8 As button:
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =Color.Black
            DisplayMode: =DisplayMode.Disabled
            Text: |
                =SelectedRoom.Text
            Width: =319
            X: =987
            Y: =319
            ZIndex: =7

        Spinner_2 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =60
            ZIndex: =12

            Rectangle2_2 As rectangle:
                BorderColor: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(255, 255, 255, 1)
                Height: =678
                Visible: =ShowLoading
                Width: =1326
                ZIndex: =8

            Spinner1_2 As Spinner:
                BasePaletteColor: =
                DisplayMode: =DisplayMode.Edit
                FontColor: =
                Height: =200
                Visible: =ShowLoading
                Width: =200
                X: =577
                Y: =217
                ZIndex: =9

            Label8_2 As label:
                Align: =Align.Center
                Text: ="Loading..."
                Visible: =ShowLoading
                Width: =442
                X: =456
                Y: =404
                ZIndex: =10

    DateSelectionPopup As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.Regular
        Height: =Parent.Height - 90
        RadiusBottomLeft: =10
        RadiusBottomRight: =10
        RadiusTopLeft: =10
        RadiusTopRight: =10
        Visible: =ShowDatePicker
        Width: =(Parent.Width - (20 * 2)) / 3
        X: =RoomSelectionPopup.Width + 40
        Y: =60
        ZIndex: =16

        Button3_4 As button:
            DisplayMode: =DisplayMode.Disabled
            Height: =Parent.Height
            Text: =""
            Width: =Parent.Width
            X: =
            ZIndex: =1

        Rectangle1_1 As rectangle:
            Fill: =RGBA(71, 158, 245, 1)
            Height: =26
            Width: =442
            Y: =65
            ZIndex: =2

        Rectangle1 As rectangle:
            Height: =65
            Width: =442
            ZIndex: =3

        Icon3_1 As icon.Cancel:
            Color: =RGBA(255, 255, 255, 1)
            Height: =44
            Icon: =Icon.Cancel
            OnSelect: =Set(ShowDatePicker, false)
            Width: =44
            X: =10
            Y: =10
            ZIndex: =4

        Button2_4 As button:
            OnSelect: =
            Text: =Text(StartDateTime, DateTimeFormat.ShortTime) & " - " & Text(EndDateTime, DateTimeFormat.ShortTime)
            Width: =319
            X: =987
            Y: =196
            ZIndex: =5

        Rectangle1_2 As rectangle:
            Height: =105
            Width: =442
            Y: =91
            ZIndex: =6

        "WeekdayGallery As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            Height: =40
            Items: =["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"]
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =MonthDayGallery.TemplateWidth
            Width: =361
            X: =40
            Y: =251
            ZIndex: =7

            Title1 As label:
                Align: =Align.Center
                Height: =27
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.Value
                VerticalAlign: =VerticalAlign.Top
                Width: =30
                X: =Parent.TemplateWidth / 2 - Self.Width / 2
                Y: =Parent.TemplateHeight / 2 - Self.Height / 2
                ZIndex: =2

        Label4 As label:
            Align: =Align.Center
            Height: =26
            Text: =Text(DateSelected, "[$-en-US]dddd")
            Width: =442
            Y: =65
            ZIndex: =8

        "MonthDayGallery As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            Height: =297
            Items: =[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =50
            Width: =361
            WrapCount: =7
            X: =40
            Y: =276
            ZIndex: =9

            Circle3_1 As circle:
                Fill: =If(DateAdd(firstDayInView, ThisItem.Value) = DateSelected && DateAdd(firstDayInView, ThisItem.Value) >= Today() && DateAdd(firstDayInView, ThisItem.Value) >= firstDayOfMonth, RGBA(121, 121, 121, 1), RGBA(0,0,0,0))
                Height: =33
                Visible: =DateAdd(firstDayInView, ThisItem.Value, TimeUnit.Days) = DateSelected && Title3.Visible
                Width: =33
                X: =Title3.X
                Y: =Title3.Y
                ZIndex: =1

            Title3 As label:
                Align: =Align.Center
                Color: =If(DateAdd(firstDayInView,ThisItem.Value) < Today(), ColorFade(RGBA(47,41,43,1), 80%), RGBA(47,41,43,1))
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =33
                OnSelect: |-
                    =If (
                        DateAdd(
                            firstDayInView,
                            ThisItem.Value
                        ) >= Today(),
                        Select(Parent);
                        Set(
                            DateSelected,
                            DateAdd(
                                firstDayInView,
                                ThisItem.Value,
                                TimeUnit.Days
                            )
                        )
                    )
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Day(DateAdd(firstDayInView,ThisItem.Value,TimeUnit.Days))
                Visible: =If(DateAdd(firstDayInView,ThisItem.Value,TimeUnit.Days) < firstDayOfMonth || DateAdd(firstDayInView,ThisItem.Value,TimeUnit.Days) > LastDayOfMonth,false,true)
                Width: =33
                X: =Parent.TemplateWidth / 2 - Self.Width / 2
                Y: =Parent.TemplateHeight / 2 - Self.Height / 2
                ZIndex: =2

        Label4_1 As label:
            Align: =Align.Center
            Height: =32
            Text: =Text(DateSelected, "[$-en-US]mmmm")
            Width: =442
            Y: =91
            ZIndex: =10

        Label4_2 As label:
            Align: =Align.Center
            Height: =49
            Size: =40
            Text: =Text(DateSelected, "[$-en-US]dd")
            Width: =442
            Y: =119
            ZIndex: =11

        Label4_3 As label:
            Align: =Align.Center
            Height: =28
            Text: =Text(DateSelected, "[$-en-US]yyyy")
            Width: =442
            Y: =168
            ZIndex: =12

        Button2_6 As button:
            Height: =55
            OnSelect: |
                =Set(DateSpinner, true);
                Set(StartTimeMinutes, Hour(StartDateTime)*60 + Minute(StartDateTime));
                Set(EndTimeMinutes, Hour(EndDateTime)*60 + Minute(EndDateTime));
                
                Set(StartDateTime, DateAdd(DateSelected, StartTimeMinutes, TimeUnit.Minutes));
                Set(EndDateTime, DateAdd(DateSelected, EndTimeMinutes, TimeUnit.Minutes));
                
                Set(StartDateTimeUTC, Text(DateAdd(StartDateTime, TimeZoneOffset(), TimeUnit.Minutes), "[$-en-US]yyyy-mm-ddThh:mm") & ":00.000Z");
                Set(EndDateTimeUTC, Text(DateAdd(EndDateTime, TimeZoneOffset(), TimeUnit.Minutes), "[$-en-US]yyyy-mm-ddThh:mm") & ":00.000Z");
                
                Concurrent(
                    ClearCollect(ScheduleRoom102, 'Serwer Studia'.Getclassesfromroom("1030-ETI-102", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom103, 'Serwer Studia'.Getclassesfromroom("1030-ETI-103", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom104, 'Serwer Studia'.Getclassesfromroom("1030-ETI-104", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom105, 'Serwer Studia'.Getclassesfromroom("1030-ETI-105-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Concurrent(
                    ClearCollect(ScheduleRoom106, 'Serwer Studia'.Getclassesfromroom("1030-ETI-106", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom107, 'Serwer Studia'.Getclassesfromroom("1030-ETI-107", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom161, 'Serwer Studia'.Getclassesfromroom("1030-ETI-161", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom108, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Concurrent(
                    ClearCollect(ScheduleRoom116, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom117, 'Serwer Studia'.Getclassesfromroom("1030-ETI-117", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom116AR, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom133, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Concurrent(
                    ClearCollect(ScheduleRoom120, 'Serwer Studia'.Getclassesfromroom("1030-ETI-120", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom121, 'Serwer Studia'.Getclassesfromroom("1030-ETI-121", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom122, 'Serwer Studia'.Getclassesfromroom("1030-ETI-122", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Set(DateSpinner, false);
                UpdateContext({SelectedRoom: Blank()});
                Set(ShowDatePicker, false)
            Text: ="SAVE"
            Width: =336
            X: =49
            Y: =598
            ZIndex: =13

        Label4_4 As label:
            Align: =Align.Center
            Height: =44
            Size: =20
            Text: ="SELECT DATE"
            Width: =281
            X: =80
            Y: =10
            ZIndex: =14

        Icon4 As icon.ArrowLeft:
            Height: =35
            Icon: =Icon.ArrowLeft
            OnSelect: |-
                =If(DateAdd(firstDayOfMonth, -1, TimeUnit.Days) >= Today(),
                    Set(firstDayOfMonth, DateAdd(firstDayOfMonth, -1, TimeUnit.Months));
                    Set(firstDayInView, DateAdd(firstDayOfMonth, -(Mod(Weekday(firstDayOfMonth)-2,7)+1), TimeUnit.Days));
                    Set(LastDayOfMonth, DateAdd(DateAdd(firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                )
            Width: =35
            X: =54
            Y: =204
            ZIndex: =15

        Icon5 As icon.ArrowRight:
            Height: =35
            Icon: =Icon.ArrowRight
            OnSelect: |-
                =Set(firstDayOfMonth, DateAdd(firstDayOfMonth, 1, TimeUnit.Months));
                Set(firstDayInView, DateAdd(firstDayOfMonth, -(Mod(Weekday(firstDayOfMonth)-2, 7)+1),TimeUnit.Days));
                Set(LastDayOfMonth, DateAdd(DateAdd(firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
            Width: =35
            X: =355
            Y: =204
            ZIndex: =16

        Label5 As label:
            Align: =Align.Center
            Text: =Text(firstDayOfMonth, "[$-en-US]mmmm yyyy")
            X: =147
            Y: =201
            ZIndex: =17

        Spinner As group:
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =21

            Rectangle2 As rectangle:
                BorderColor: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(255, 255, 255, 1)
                Height: =678
                Visible: =DateSpinner
                Width: =442
                ZIndex: =18

            Spinner1 As Spinner:
                BasePaletteColor: =
                DisplayMode: =DisplayMode.Edit
                FontColor: =
                Height: =200
                Visible: =DateSpinner
                Width: =200
                X: =122
                Y: =226
                ZIndex: =19

            Label8 As label:
                Align: =Align.Center
                Text: ="Syncing with Server Studia..."
                Visible: =DateSpinner
                Width: =442
                Y: =377
                ZIndex: =20

    TimeSelectionPopup As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.Regular
        Height: =Parent.Height - 90
        RadiusBottomLeft: =10
        RadiusBottomRight: =10
        RadiusTopLeft: =10
        RadiusTopRight: =10
        Visible: =ShowTimePicker
        Width: =(Parent.Width - (20 * 2)) / 3
        X: =RoomSelectionPopup.Width + 40
        Y: =60
        ZIndex: =17

        Button3_5 As button:
            DisplayMode: =DisplayMode.Disabled
            Height: =Parent.Height
            Text: =""
            Width: =Parent.Width
            X: =
            ZIndex: =1

        Rectangle1_3 As rectangle:
            Height: =65
            Width: =442
            ZIndex: =3

        Icon3_2 As icon.Cancel:
            Color: =RGBA(255, 255, 255, 1)
            Height: =44
            Icon: =Icon.Cancel
            OnSelect: =Set(ShowTimePicker, false)
            Width: =44
            X: =10
            Y: =10
            ZIndex: =4

        ButtonSaveTime As button:
            Height: =55
            OnSelect: |
                =Set(StartDateTime, DateAdd(DateSelected, DropdownStartTime.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes', TimeUnit.Minutes));
                Set(EndDateTime, DateAdd(StartDateTime, If(DropdownStartTime.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes' >= DropdownEndTime.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes', DropdownEndTime.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes' + 1440 - DropdownStartTime.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes', DropdownEndTime.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes' - DropdownStartTime.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes'), TimeUnit.Minutes));
                
                Set(StartDateTimeUTC, Text(DateAdd(StartDateTime, TimeZoneOffset(), TimeUnit.Minutes), "[$-en-US]yyyy-mm-ddThh:mm") & ":00.000Z");
                Set(EndDateTimeUTC, Text(DateAdd(EndDateTime, TimeZoneOffset(), TimeUnit.Minutes), "[$-en-US]yyyy-mm-ddThh:mm") & ":00.000Z");
                
                Set(ShowTimePicker, false)
            Text: ="SAVE"
            Width: =336
            X: =54
            Y: =593
            ZIndex: =13

        Label4_5 As label:
            Align: =Align.Center
            Height: =44
            Size: =20
            Text: ="SELECT DATE"
            Width: =281
            X: =80
            Y: =10
            ZIndex: =14

        DropdownStartTime As dropdown:
            BorderColor: =If(ButtonSaveTime.DisplayMode = DisplayMode.Edit, RGBA(120, 120, 120, 1), Color.Red)
            ChevronBackground: =RGBA(62, 96, 170, 0)
            ChevronDisabledBackground: =RGBA(159, 167, 165, 1)
            ChevronDisabledFill: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            ChevronFill: =RGBA(18, 107, 240, 1)
            Default: =If(ResetTrue, LookUp(Times, Text = Lower(Text(StartDateTime, DateTimeFormat.ShortTime))).Text)
            Items: =Times
            Width: =ButtonSaveTime.Width / 2 - 10
            X: =ButtonSaveTime.X
            Y: =116
            ZIndex: =15

        Label6 As label:
            FontWeight: =FontWeight.Semibold
            Text: ="Start"
            Width: =158
            X: =54
            Y: =76
            ZIndex: =17

        Label6_1 As label:
            FontWeight: =FontWeight.Semibold
            Text: ="End"
            Width: =158
            X: =232
            Y: =76
            ZIndex: =18

        DropdownEndTime As dropdown:
            BorderColor: =If(ButtonSaveTime.DisplayMode = DisplayMode.Edit, RGBA(120, 120, 120, 1), Color.Red)
            ChevronBackground: =RGBA(62, 96, 170, 0)
            ChevronDisabledBackground: =RGBA(159, 167, 165, 1)
            ChevronDisabledFill: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            ChevronFill: =RGBA(18, 107, 240, 1)
            Default: =If(IsBlank(DurationGallery.Selected) && IsBlank(DurationSelection) || ResetTrue, LookUp(Times, Text = Lower(Text(EndDateTime, DateTimeFormat.ShortTime))).Text, !IsBlank(DurationSelection), LookUp(Times, Minutes = Mod(DropdownStartTime.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes' + DurationGallery.Selected.Minutes, 1440)).Text)
            Items: =Times
            Width: =ButtonSaveTime.Width / 2 - 10
            X: =232
            Y: =116
            ZIndex: =19

        "DurationGallery As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            Height: =355
            Items: =Durations
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            ShowScrollbar: =false
            TemplatePadding: =15
            TemplateSize: =90
            Width: =361
            WrapCount: =2
            X: =40
            Y: =190
            ZIndex: =20

            Button5_1 As button:
                BorderColor: =RGBA(18, 107, 240, 1)
                Color: =Self.BorderColor
                Fill: =If(ThisItem.Minutes = DurationSelection.Minutes, RGBA(18, 107, 240, .2), RGBA(0, 0, 0, 0))
                Height: =Parent.TemplateHeight
                OnSelect: |-
                    =Select(Parent);
                    If(IsBlank(DurationSelection) || ThisItem.Time <> DurationSelection.Time, Set(DurationSelection, ThisItem), Set(DurationSelection, Blank()));
                    UpdateContext({ResetTrue: false})
                Text: ="+ " & ThisItem.Time
                Width: =Parent.TemplateWidth
                ZIndex: =3

    CheckSchedulePopUp As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.Regular
        Height: =Parent.Height - 90
        RadiusBottomLeft: =10
        RadiusBottomRight: =10
        RadiusTopLeft: =10
        RadiusTopRight: =10
        Visible: =varViewSchedule
        Width: |-
            =If (ShowDatePicker || ShowTimePicker,
                Parent.Width * 2 / 3 - 45,
                Parent.Width - (20 * 2)
            )
        X: =20
        Y: =60
        ZIndex: =18

        Button3_6 As button:
            DisplayMode: =DisplayMode.Disabled
            Height: =Parent.Height
            Text: =""
            Width: =Parent.Width
            ZIndex: =1

        Icon3_3 As icon.Cancel:
            Height: =44
            Icon: =Icon.Cancel
            OnSelect: |-
                =Set(ShowLoading, true);
                UpdateContext({varViewSchedule: false});
                UpdateContext({SelectedRoom: Blank()});
                Set(ShowLoading, false)
            Visible: =!(ShowDatePicker || ShowTimePicker)
            Width: =44
            X: =Parent.Width - Self.Width - 10
            Y: =10
            ZIndex: =2

        Button2_9 As button:
            OnSelect: |
                =Set(firstDayOfMonth, DateAdd(DateSelected, 1 - Day(DateSelected), TimeUnit.Days));
                Set(firstDayInView, DateAdd(firstDayOfMonth, -(Mod(Weekday(firstDayOfMonth)-2,7)+1),TimeUnit.Days));
                Set(LastDayOfMonth, DateAdd(DateAdd(firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                UpdateContext({ResetDateStore: DateSelected});
                UpdateContext({ResetFirstDayOfMonth: DateAdd(DateSelected, 1 - Day(DateSelected), TimeUnit.Days)});
                Set(ShowDatePicker, true)
            Text: =If(DateDiff(Today(), StartDateTime, TimeUnit.Hours) < 24, "Today", Text(StartDateTime, "[$-en-US]mmmm dd, yyyy"))
            Width: =319
            X: =985
            Y: =70
            ZIndex: =3

        Button2_10 As button:
            OnSelect: |
                =Set(ShowTimePicker, true)
            Text: |+
                =Text(StartDateTime, DateTimeFormat.ShortTime) & " - " & Text(EndDateTime, DateTimeFormat.ShortTime)
                
            Width: =319
            X: =985
            Y: =137
            ZIndex: =4

        Container2_1 As groupContainer:
            Height: =Parent.Height - 20
            RadiusBottomLeft: =10
            RadiusBottomRight: =10
            RadiusTopLeft: =10
            RadiusTopRight: =10
            Width: =942
            X: =10
            Y: =10
            ZIndex: =5

            Image2_1 As image:
                Height: =Parent.Height
                Image: ='Screenshot 2024-03-17 at 22.21.45'
                ImagePosition: =ImagePosition.Stretch
                Width: =Parent.Width
                ZIndex: =1

            room103_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "103",
                        "X"
                    )
                Width: =32
                X: =109
                Y: =352
                ZIndex: =2

            room104_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "104",
                        "X"
                    )
                Width: =32
                X: =141
                Y: =352
                ZIndex: =3

            room102_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "102",
                        "X"
                    )
                Width: =34
                X: =75
                Y: =352
                ZIndex: =4

            room161_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =118
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "161",
                        "X"
                    )
                Width: =95
                X: =151
                Y: =176
                ZIndex: =11

            room107_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "107",
                        "X"
                    )
                Width: =33
                X: =260
                Y: =352
                ZIndex: =12

            room108_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "108",
                        "X"
                    )
                Width: =48
                X: =293
                Y: =352
                ZIndex: =13

            room106_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "106",
                        "X"
                    )
                Width: =34
                X: =226
                Y: =352
                ZIndex: =14

            room105_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =83
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "105",
                        "X"
                    )
                Width: =74
                X: =161
                Y: =415
                ZIndex: =15

            room116_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "116",
                        "X"
                    )
                Width: =48
                X: =560
                Y: =352
                ZIndex: =16

            room117_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "117",
                        "X"
                    )
                Width: =34
                X: =608
                Y: =352
                ZIndex: =17

            room133_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =118
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "133",
                        "X"
                    )
                Width: =95
                X: =622
                Y: =176
                ZIndex: =18

            "'room116-AR_1' As button":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =83
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "116-AR",
                        "X"
                    )
                Width: =74
                X: =632
                Y: =415
                ZIndex: =19

            room120_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "120",
                        "X"
                    )
                Width: =34
                X: =725
                Y: =352
                ZIndex: =20

            room121_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "121",
                        "X"
                    )
                Width: =34
                X: =759
                Y: =352
                ZIndex: =21

            room122_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =59
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "122",
                        "X"
                    )
                Width: =33
                X: =793
                Y: =332
                ZIndex: =22

        Label7_1 As label:
            Text: |-
                ="Selected room:"
            X: =985
            Y: =207
            ZIndex: =6

        Button2_11 As button:
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =Color.Black
            DisplayMode: =DisplayMode.Disabled
            Text: |
                =SelectedRoom.Text
            Width: =319
            X: =985
            Y: =259
            ZIndex: =7

        "Gallery1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            Height: =322
            Items: |-
                =Sort(Filter(
                    'Serwer Studia'.Getclassesfromroom(
                        "1030-ETI-" & SelectedRoom.Text,
                        {
                            date: Text(
                                DateSelected,
                                "yyyy-mm-dd"
                            )
                        }
                    ).plan,
                    With(
                        {
                            classStart: DateAdd(
                                DateValue(
                                    date,
                                    "en"
                                ),
                                hour + 0.25,
                                TimeUnit.Hours
                            ),
                            classEnd: DateAdd(
                                DateValue(
                                    date,
                                    "en"
                                ),
                                hour + Value(length),
                                TimeUnit.Hours
                            )
                        },
                        Or(
                            And(
                                classStart <= EndDateTime,
                                classStart >= StartDateTime
                            ),
                            And(
                                classEnd <= EndDateTime,
                                classEnd >= StartDateTime
                            ),
                            And(
                                StartDateTime <= classEnd,
                                StartDateTime >= classStart
                            )
                        )
                    )
                ),hour,SortOrder.Ascending)
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =104
            Transition: =Transition.Push
            Visible: =!(IsBlank(SelectedRoom))
            Width: =363
            X: =Container2_1.X + Container2_1.Width + 6
            Y: =319
            ZIndex: =11

            Button2_12 As button:
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =Color.Black
                DisplayMode: =DisplayMode.Disabled
                Fill: =
                Height: =Parent.TemplateHeight - 20
                Text: =""
                Width: =Parent.TemplateWidth - 10
                X: |
                    =5
                Y: =10
                ZIndex: =1

            Title4 As label:
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =25
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.skr
                VerticalAlign: =VerticalAlign.Top
                Width: =282
                X: =20
                Y: =28
                ZIndex: =2

            Subtitle2_6 As label:
                Align: =Align.Center
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =23
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =11
                Text: |-
                    =DateAdd(TimeValue(ThisItem.hour&":00"),15,TimeUnit.Minutes)&" - "&DateAdd(TimeValue(ThisItem.hour&":00"),ThisItem.length,TimeUnit.Hours)
                X: =45
                Y: =53
                ZIndex: =6

            Subtitle2_8 As label:
                Align: =Align.Center
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =23
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =11
                Text: =ThisItem.type
                Width: =32
                X: =314
                Y: =40
                ZIndex: =8

        Spinner_3 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =60
            ZIndex: =12

            Rectangle2_3 As rectangle:
                BorderColor: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(255, 255, 255, 1)
                Height: =678
                Visible: =ShowLoading
                Width: =1326
                ZIndex: =8

            Spinner1_3 As Spinner:
                BasePaletteColor: =
                DisplayMode: =DisplayMode.Edit
                FontColor: =
                Height: =200
                Visible: =ShowLoading
                Width: =200
                X: =577
                Y: =217
                ZIndex: =9

            Label8_3 As label:
                Align: =Align.Center
                Text: ="Loading..."
                Visible: =ShowLoading
                Width: =442
                X: =456
                Y: =404
                ZIndex: =10

    TextCanvas1 As Text:
        DisplayMode: =DisplayMode.Edit
        FontColor: =
        Height: =32
        Text: |-
            ="version: 0.0.2"
        Visible: |-
            =If(
                User().Email = "01151661@pw.edu.pl",
                true,
                false
            )
        Width: =306
        X: =31
        Y: =706
        ZIndex: =19

