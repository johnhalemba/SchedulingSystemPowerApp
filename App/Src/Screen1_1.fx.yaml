Screen1_1 As screen:
    Fill: =RGBA(224, 224, 224, 1)
    OnVisible: |
        =Set(DurationSelection, Blank());
        UpdateContext({ResetTrue: false});
        UpdateContext({ResetTrue: true});
        UpdateContext({varRoomSelection:false});
        UpdateContext({varShowMainScreen:true})

    CheckSchedulePopUp_1 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.Regular
        Height: =Parent.Height - 90
        RadiusBottomLeft: =10
        RadiusBottomRight: =10
        RadiusTopLeft: =10
        RadiusTopRight: =10
        Visible: =varViewSchedule
        Width: |-
            =If (ShowDatePicker || ShowTimePicker,
                Parent.Width * 2 / 3 - 45,
                Parent.Width - (20 * 2)
            )
        X: =20
        Y: =60
        ZIndex: =1

        Button3_8 As button:
            DisplayMode: =DisplayMode.Disabled
            Height: =Parent.Height
            Text: =""
            Width: =Parent.Width
            ZIndex: =1

        Icon3_5 As icon.Cancel:
            Height: =44
            Icon: =Icon.Cancel
            OnSelect: |-
                =Set(ShowLoading, true);
                UpdateContext({varViewSchedule: false});
                UpdateContext({SelectedRoom: Blank()});
                Set(ShowLoading, false)
            Visible: =!(ShowDatePicker || ShowTimePicker)
            Width: =44
            X: =Parent.Width - Self.Width - 10
            Y: =10
            ZIndex: =2

        Button2_16 As button:
            OnSelect: |
                =Set(firstDayOfMonth, DateAdd(DateSelected, 1 - Day(DateSelected), TimeUnit.Days));
                Set(firstDayInView, DateAdd(firstDayOfMonth, -(Mod(Weekday(firstDayOfMonth)-2,7)+1),TimeUnit.Days));
                Set(LastDayOfMonth, DateAdd(DateAdd(firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                UpdateContext({ResetDateStore: DateSelected});
                UpdateContext({ResetFirstDayOfMonth: DateAdd(DateSelected, 1 - Day(DateSelected), TimeUnit.Days)});
                Set(ShowDatePicker, true)
            Text: =If(DateDiff(Today(), StartDateTime, TimeUnit.Hours) < 24, "Today", Text(StartDateTime, "[$-en-US]mmmm dd, yyyy"))
            Width: =319
            X: =985
            Y: =70
            ZIndex: =3

        Button2_17 As button:
            OnSelect: |
                =Set(ShowTimePicker, true)
            Text: |+
                =Text(StartDateTime, DateTimeFormat.ShortTime) & " - " & Text(EndDateTime, DateTimeFormat.ShortTime)
                
            Width: =319
            X: =985
            Y: =137
            ZIndex: =4

        Container2_3 As groupContainer:
            Height: =Parent.Height - 20
            RadiusBottomLeft: =10
            RadiusBottomRight: =10
            RadiusTopLeft: =10
            RadiusTopRight: =10
            Width: =942
            X: =10
            Y: =10
            ZIndex: =5

            Image2_3 As image:
                Height: =Parent.Height
                Image: ='Screenshot 2024-03-17 at 22.21.45'
                ImagePosition: =ImagePosition.Stretch
                Width: =Parent.Width
                ZIndex: =1

            room103_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "103",
                        "X"
                    )
                Width: =32
                X: =109
                Y: =352
                ZIndex: =2

            room104_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "104",
                        "X"
                    )
                Width: =32
                X: =141
                Y: =352
                ZIndex: =3

            room102_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "102",
                        "X"
                    )
                Width: =34
                X: =75
                Y: =352
                ZIndex: =4

            room161_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =118
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "161",
                        "X"
                    )
                Width: =95
                X: =151
                Y: =176
                ZIndex: =11

            room107_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "107",
                        "X"
                    )
                Width: =33
                X: =260
                Y: =352
                ZIndex: =12

            room108_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "108",
                        "X"
                    )
                Width: =48
                X: =293
                Y: =352
                ZIndex: =13

            room106_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "106",
                        "X"
                    )
                Width: =34
                X: =226
                Y: =352
                ZIndex: =14

            room105_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =83
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "105",
                        "X"
                    )
                Width: =74
                X: =161
                Y: =415
                ZIndex: =15

            room116_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "116",
                        "X"
                    )
                Width: =48
                X: =560
                Y: =352
                ZIndex: =16

            room117_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "117",
                        "X"
                    )
                Width: =34
                X: =608
                Y: =352
                ZIndex: =17

            room133_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =118
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "133",
                        "X"
                    )
                Width: =95
                X: =622
                Y: =176
                ZIndex: =18

            "'room116-AR_3' As button":
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =83
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "116-AR",
                        "X"
                    )
                Width: =74
                X: =632
                Y: =415
                ZIndex: =19

            room120_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "120",
                        "X"
                    )
                Width: =34
                X: =725
                Y: =352
                ZIndex: =20

            room121_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (
                        SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =39
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "121",
                        "X"
                    )
                Width: =34
                X: =759
                Y: =352
                ZIndex: =21

            room122_3 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =1
                Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                DisabledColor: =Self.Color
                DisabledFill: |-
                    =If(
                        Self.Fill = Color.Red,
                        Color.Red
                    )
                DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: |-
                    =If (SelectedRoom = Self,
                        Color.Yellow,
                        Color.Green
                    )
                FocusedBorderThickness: =1
                Height: =59
                HoverColor: =ColorFade(Self.Color, 15%)
                HoverFill: =ColorFade(Self.Fill, 18%)
                OnSelect: |-
                    =UpdateContext({SelectedRoom: Self})
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =9
                Text: |-
                    =If(
                        Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                        "122",
                        "X"
                    )
                Width: =33
                X: =793
                Y: =332
                ZIndex: =22

        Label7_3 As label:
            Text: |-
                ="Selected room:"
            X: =985
            Y: =207
            ZIndex: =6

        Button2_18 As button:
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =Color.Black
            DisplayMode: =DisplayMode.Disabled
            Text: |
                =SelectedRoom.Text
            Width: =319
            X: =985
            Y: =259
            ZIndex: =7

        "Gallery1_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            Height: =322
            Items: |-
                =Sort(Filter(
                    'Serwer Studia'.Getclassesfromroom(
                        "1030-ETI-" & SelectedRoom.Text,
                        {
                            date: Text(
                                DateSelected,
                                "yyyy-mm-dd"
                            )
                        }
                    ).plan,
                    With(
                        {
                            classStart: DateAdd(
                                DateValue(
                                    date,
                                    "en"
                                ),
                                hour + 0.25,
                                TimeUnit.Hours
                            ),
                            classEnd: DateAdd(
                                DateValue(
                                    date,
                                    "en"
                                ),
                                hour + Value(length),
                                TimeUnit.Hours
                            )
                        },
                        Or(
                            And(
                                classStart <= EndDateTime,
                                classStart >= StartDateTime
                            ),
                            And(
                                classEnd <= EndDateTime,
                                classEnd >= StartDateTime
                            ),
                            And(
                                StartDateTime <= classEnd,
                                StartDateTime >= classStart
                            )
                        )
                    )
                ),hour,SortOrder.Ascending)
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =104
            Transition: =Transition.Push
            Visible: =!(IsBlank(SelectedRoom))
            Width: =363
            X: =Container2_3.X + Container2_3.Width + 6
            Y: =319
            ZIndex: =11

            Button2_19 As button:
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =Color.Black
                DisplayMode: =DisplayMode.Disabled
                Fill: =
                Height: =Parent.TemplateHeight - 20
                Text: =""
                Width: =Parent.TemplateWidth - 10
                X: |
                    =5
                Y: =10
                ZIndex: =1

            Title4_1 As label:
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =25
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.skr
                VerticalAlign: =VerticalAlign.Top
                Width: =282
                X: =20
                Y: =28
                ZIndex: =2

            Subtitle2_23 As label:
                Align: =Align.Center
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =23
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =11
                Text: |-
                    =DateAdd(TimeValue(ThisItem.hour&":00"),15,TimeUnit.Minutes)&" - "&DateAdd(TimeValue(ThisItem.hour&":00"),ThisItem.length,TimeUnit.Hours)
                X: =45
                Y: =53
                ZIndex: =6

            Subtitle2_22 As label:
                Align: =Align.Center
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =23
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =11
                Text: =ThisItem.type
                Width: =32
                X: =314
                Y: =40
                ZIndex: =8

        Spinner_5 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =60
            ZIndex: =12

            Rectangle2_6 As rectangle:
                BorderColor: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(255, 255, 255, 1)
                Height: =678
                Visible: =ShowLoading
                Width: =1326
                ZIndex: =8

            Spinner1_6 As Spinner:
                BasePaletteColor: =
                DisplayMode: =DisplayMode.Edit
                FontColor: =
                Height: =200
                Visible: =ShowLoading
                Width: =200
                X: =577
                Y: =217
                ZIndex: =9

            Label8_6 As label:
                Align: =Align.Center
                Text: ="Loading..."
                Visible: =ShowLoading
                Width: =442
                X: =456
                Y: =404
                ZIndex: =10

    TextCanvas1_1 As Text:
        DisplayMode: =DisplayMode.Edit
        FontColor: =
        Height: =32
        Text: |-
            ="version: 0.0.2"
        Visible: |-
            =If(
                User().Email = "01151661@pw.edu.pl",
                true,
                false
            )
        Width: =306
        X: =31
        Y: =706
        ZIndex: =2

    mainContainer As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.Regular
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =10
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =5
        PaddingLeft: =5
        PaddingRight: =5
        PaddingTop: =5
        Width: =App.Width
        ZIndex: =3

        ContainerHeader_2 As groupContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.Regular
            Fill: =RGBA(244,244,244,1)
            FillPortions: =0
            Height: =50
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            RadiusBottomLeft: =10
            RadiusBottomRight: =10
            RadiusTopLeft: =10
            RadiusTopRight: =10
            Width: =Parent.Width - (20 * 2)
            X: =20
            ZIndex: =1

            Button3_12 As button:
                DisplayMode: =DisplayMode.Disabled
                Height: =Parent.Height
                Text: =""
                Visible: =false
                Width: =Parent.Width
                ZIndex: =1

            Header1_2 As Header:
                BasePaletteColor: =RGBA(224, 224, 224, 1)
                DisplayMode: =DisplayMode.Edit
                Font: =Font.Lato
                FontColor: =
                Height: =Parent.Height - 50
                IsProfilePictureVisible: =true
                IsTitleVisible: =true
                Logo: ='Screenshot 2024-03-02 184341'
                OnSelectLogo: =Navigate(Screen1_1, Transition.Pop)
                Style: ='Header.Style'.Neutral
                Title: ="FeiT Reservation System"
                UserEmail: =User().Email
                UserImage: =User().Image
                UserName: =User().FullName
                Visible: =false
                Width: =Parent.Width
                X: =0
                Y: =0
                ZIndex: =2

            Rectangle3_2 As rectangle:
                Fill: |-
                    =ColorValue("#FFFFFF")
                Height: =50
                Visible: =false
                Width: =1326
                Y: =50
                ZIndex: =3

            BadgeCanvas1_2 As Badge:
                BasePaletteColor: =
                Content: =Left(User().FullName, 1) & Mid(User().FullName, Find(" ", User().FullName) + 1, 1)
                DisplayMode: =DisplayMode.Edit
                FontColor: =
                Height: =37
                Width: =37
                X: =Parent.Width - Self.Width - 13
                Y: =Parent.Height - Self.Height - (Rectangle3_2.Height / 2) + (Self.Height / 2)
                ZIndex: =4

            Label9_2 As label:
                Align: =Align.Right
                DisplayMode: =DisplayMode.View
                Text: =User().FullName
                Visible: =App.Width > 800
                Width: =383
                X: =Parent.Width - Self.Width - BadgeCanvas1_2.Width - 20
                Y: =5
                ZIndex: =5

            Image4_2 As image:
                Height: =37
                Image: ='Screenshot 2024-03-02 184341'
                Width: =37
                X: =22
                Y: =Parent.Height - Self.Height - (Rectangle3_2.Height / 2) + (Self.Height / 2)
                ZIndex: =6

            Label10_2 As label:
                Font: ="Adagio Slab"
                FontWeight: =FontWeight.Semibold
                Size: =15
                Text: ="FEIT Reservation System"
                Width: =459
                X: =70
                Y: =Parent.Height - Self.Height - (Rectangle3_2.Height / 2) + (Self.Height / 2)
                ZIndex: =7

        ContainerMainScreen As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Fill: =RGBA(244,244,244,1)
            Height: =Parent.Height - 100
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutGap: =10
            LayoutMinHeight: =100
            LayoutMinWidth: =10
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowY: =LayoutOverflow.Scroll
            LayoutWrap: =true
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            Visible: =varShowMainScreen
            ZIndex: =2

            Container9 As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =5
                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                LayoutMinHeight: =0
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =1

                Label3 As label:
                    AlignInContainer: =AlignInContainer.Start
                    AutoHeight: =true
                    FontWeight: =FontWeight.Bold
                    PaddingLeft: =15
                    PaddingRight: =15
                    Size: =25
                    Text: ="Welcome, "&Left(User().FullName, Find(" ",User().FullName) - 1)&"!"
                    Width: =417
                    X: =20
                    ZIndex: =1

                Container5_3 As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    Height: =556
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =5
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =10
                    PaddingLeft: =10
                    PaddingRight: =10
                    PaddingTop: =10
                    Width: =Parent.Width
                    X: =30
                    Y: =88
                    ZIndex: =3

                    Label3_1 As label:
                        Align: =Align.Center
                        AutoHeight: =true
                        FontWeight: =FontWeight.Semibold
                        Size: =15
                        Text: ="What would you like to do?"
                        Width: =623
                        ZIndex: =1

                    Container3_8 As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        Height: =297
                        LayoutMinHeight: =50
                        LayoutMinWidth: =50
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =391
                        X: =30
                        Y: =88
                        ZIndex: =2

                        btn_MakeReservation_8 As button:
                            Color: |-
                                =If(
                                    btn_Overlay_8.Pressed,
                                    WEITI_Szafirowy,
                                    Color.White
                                )
                            Fill: |-
                                =If(
                                    btn_Overlay_8.Pressed,
                                    Color.White,
                                    WEITI_Szafirowy
                                )
                            Height: =Parent.Height - Self.BorderThickness
                            Text: ="Make a reservation"
                            Width: =Parent.Width - Self.BorderThickness
                            X: =2
                            Y: =2
                            ZIndex: =1

                        btn_Overlay_8 As button:
                            BorderStyle: =BorderStyle.None
                            Color: =Color.Transparent
                            DisabledColor: =Color.Transparent
                            DisabledFill: =Color.Transparent
                            Fill: =Color.Transparent
                            Height: =btn_MakeReservation_8.Height
                            HoverColor: =Color.Transparent
                            HoverFill: =RGBA(0, 0, 0, 0.05)
                            OnSelect: |-
                                =UpdateContext({LoadingDone: 0});
                                Set(ShowLoading, true);
                                UpdateContext({varRoomSelection: true});
                                UpdateContext({LoadingDone: LoadingDone + 1});
                                UpdateContext({varShowMainScreen: false});
                                UpdateContext({LoadingDone: LoadingDone + 1});
                                Set(DateSelected, Today());
                                UpdateContext({LoadingDone: LoadingDone + 1});
                                Set(DateTimeRoomChange, true);
                                UpdateContext({LoadingDone: LoadingDone + 1});
                                If( Mod(Minute(Now()), 30) <= 14,
                                    Set(StartDateTime, DateAdd(Now(), -Mod(Minute(Now()), 30), TimeUnit.Minutes));
                                    Set(EndDateTime, DateAdd(StartDateTime, 30, TimeUnit.Minutes)),
                                    Mod(Minute(Now()), 30) > 15,
                                    Set(StartDateTime, DateAdd(Now(), -Mod(Minute(Now()), 30), TimeUnit.Minutes));
                                    Set(EndDateTime, DateAdd(StartDateTime, 30, TimeUnit.Minutes)),
                                    Set(StartDateTime, Now());
                                    Set(EndDateTime, DateAdd(Now(), -Mod(Minute(Now()), 30) + 60, TimeUnit.Minutes))
                                );
                                UpdateContext({LoadingDone: LoadingDone + 1});
                                Concurrent(
                                    ClearCollect(ScheduleRoom102, 'Serwer Studia'.Getclassesfromroom("1030-ETI-102", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom103, 'Serwer Studia'.Getclassesfromroom("1030-ETI-103", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                                UpdateContext({LoadingDone: LoadingDone + 1});
                                
                                Concurrent(
                                    ClearCollect(ScheduleRoom104, 'Serwer Studia'.Getclassesfromroom("1030-ETI-104", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom105, 'Serwer Studia'.Getclassesfromroom("1030-ETI-105-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                                UpdateContext({LoadingDone: LoadingDone + 1});
                                
                                Concurrent(
                                    ClearCollect(ScheduleRoom106, 'Serwer Studia'.Getclassesfromroom("1030-ETI-106", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom107, 'Serwer Studia'.Getclassesfromroom("1030-ETI-107", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                                UpdateContext({LoadingDone: LoadingDone + 1});
                                
                                Concurrent(
                                    ClearCollect(ScheduleRoom161, 'Serwer Studia'.Getclassesfromroom("1030-ETI-161", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom108, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                                UpdateContext({LoadingDone: LoadingDone + 1});
                                
                                Concurrent(
                                    ClearCollect(ScheduleRoom116, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom117, 'Serwer Studia'.Getclassesfromroom("1030-ETI-117", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                                
                                Concurrent(
                                    ClearCollect(ScheduleRoom116AR, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom133, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                                UpdateContext({LoadingDone: LoadingDone + 1});
                                
                                Concurrent(
                                    ClearCollect(ScheduleRoom120, 'Serwer Studia'.Getclassesfromroom("1030-ETI-120", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom121, 'Serwer Studia'.Getclassesfromroom("1030-ETI-121", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom122, 'Serwer Studia'.Getclassesfromroom("1030-ETI-122", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                                UpdateContext({LoadingDone: LoadingDone + 1});
                                UpdateContext({SelectedRoom: Blank()});
                                UpdateContext({varShowFacultyMap: true});
                                UpdateContext({varShowProperties: true});
                                Set(ShowLoading, false);
                            PressedColor: =Color.Transparent
                            PressedFill: =Color.Transparent
                            Text: ="Button"
                            Width: =btn_MakeReservation_8.Width
                            X: =btn_MakeReservation_8.X
                            Y: =2
                            ZIndex: =3

                    Container3_9 As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        Height: =297
                        LayoutMinHeight: =50
                        LayoutMinWidth: =50
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =391
                        X: =30
                        Y: =88
                        ZIndex: =3

                        btn_MakeReservation_9 As button:
                            Color: |-
                                =If(
                                    btn_Overlay_9.Pressed,
                                    WEITI_Szafirowy,
                                    Color.White
                                )
                            Fill: |-
                                =If(
                                    btn_Overlay_9.Pressed,
                                    Color.White,
                                    WEITI_Szafirowy
                                )
                            Height: =Parent.Height - Self.BorderThickness
                            Text: ="Check schedule"
                            Width: =Parent.Width - Self.BorderThickness
                            X: =2
                            Y: =2
                            ZIndex: =1

                        btn_Overlay_9 As button:
                            BorderStyle: =BorderStyle.None
                            Color: =Color.Transparent
                            DisabledColor: =Color.Transparent
                            DisabledFill: =Color.Transparent
                            Fill: =Color.Transparent
                            Height: =btn_MakeReservation_9.Height
                            HoverColor: =Color.Transparent
                            HoverFill: =RGBA(0, 0, 0, 0.05)
                            OnSelect: |-
                                =Set(ShowLoading, true);
                                UpdateContext({varRoomSelection: true});
                                Set(DateSelected, Today());
                                Set(DateTimeRoomChange, true);
                                If( Mod(Minute(Now()), 30) <= 14,
                                    Set(StartDateTime, DateAdd(Now(), -Mod(Minute(Now()), 30), TimeUnit.Minutes));
                                    Set(EndDateTime, DateAdd(StartDateTime, 30, TimeUnit.Minutes)),
                                    Mod(Minute(Now()), 30) > 15,
                                    Set(StartDateTime, DateAdd(Now(), -Mod(Minute(Now()), 30), TimeUnit.Minutes));
                                    Set(EndDateTime, DateAdd(StartDateTime, 30, TimeUnit.Minutes)),
                                    Set(StartDateTime, Now());
                                    Set(EndDateTime, DateAdd(Now(), -Mod(Minute(Now()), 30) + 60, TimeUnit.Minutes))
                                );
                                Concurrent(
                                    ClearCollect(ScheduleRoom102, 'Serwer Studia'.Getclassesfromroom("1030-ETI-102", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom103, 'Serwer Studia'.Getclassesfromroom("1030-ETI-103", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom104, 'Serwer Studia'.Getclassesfromroom("1030-ETI-104", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom105, 'Serwer Studia'.Getclassesfromroom("1030-ETI-105-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                                
                                Concurrent(
                                    ClearCollect(ScheduleRoom106, 'Serwer Studia'.Getclassesfromroom("1030-ETI-106", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom107, 'Serwer Studia'.Getclassesfromroom("1030-ETI-107", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom161, 'Serwer Studia'.Getclassesfromroom("1030-ETI-161", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom108, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                                
                                Concurrent(
                                    ClearCollect(ScheduleRoom116, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom117, 'Serwer Studia'.Getclassesfromroom("1030-ETI-117", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom116AR, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom133, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                                
                                Concurrent(
                                    ClearCollect(ScheduleRoom120, 'Serwer Studia'.Getclassesfromroom("1030-ETI-120", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom121, 'Serwer Studia'.Getclassesfromroom("1030-ETI-121", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom122, 'Serwer Studia'.Getclassesfromroom("1030-ETI-122", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                                Set(ShowLoading, false);
                            PressedColor: =Color.Transparent
                            PressedFill: =Color.Transparent
                            Text: ="Button"
                            Width: =btn_MakeReservation_9.Width
                            X: =btn_MakeReservation_9.X
                            Y: =2
                            ZIndex: =3

            Container7_3 As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Height: =584
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =10
                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                LayoutMinHeight: =0
                LayoutMinWidth: =300
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                Width: =625
                X: =Parent.Width / 2 + 10
                Y: =70
                ZIndex: =3

                Icon6 As icon.Cancel:
                    AlignInContainer: =AlignInContainer.End
                    Height: =32
                    Icon: =Icon.Cancel
                    OnSelect: =Set(showSettings, false)
                    Visible: =showSettings
                    Width: =32
                    ZIndex: =1

                Button2 As button:
                    AlignInContainer: =AlignInContainer.End
                    OnSelect: =Set(showSettings, true)
                    Text: ="Settings"
                    Visible: =!showSettings
                    ZIndex: =2

                Label11 As label:
                    AlignInContainer: =AlignInContainer.Stretch
                    AutoHeight: =true
                    FontWeight: =FontWeight.Semibold
                    LayoutMinHeight: =35
                    LayoutMinWidth: =50
                    Size: =15
                    Text: ="Your view settings"
                    Visible: =showSettings
                    ZIndex: =3

                Container12_1 As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.Center
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =Label3_4.Height + DropdownCalendarType_2.Height + 2*Self.LayoutGap
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =5
                    LayoutMinHeight: =Label3_4.Height + Self.LayoutGap + DropdownCalendarType_2.Height
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    LayoutOverflowX: =LayoutOverflow.Scroll
                    LayoutOverflowY: =LayoutOverflow.Scroll
                    LayoutWrap: =true
                    Visible: =showSettings
                    Width: =Parent.Width
                    ZIndex: =4

                    Label3_4 As label:
                        Align: =Align.Center
                        AutoHeight: =true
                        Size: =15
                        Text: |-
                            ="Source
                            "
                        Width: =100
                        ZIndex: =1

                    DropdownCalendarType_2 As dropdown:
                        AllowEmptySelection: =true
                        Default: =""
                        Items: =["Serwer Studia", "Outlook"]
                        OnChange: |-
                            =If (
                                Self.Selected.Value = "Serwer Studia",
                                UpdateContext({serwerStudia: true}),
                                UpdateContext({serwerStudia: false})
                            )
                        Tooltip: ="Select calendar..."
                        Width: =200
                        X: =713
                        Y: =20
                        ZIndex: =3

                Container12 As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =Label3_3.Height + Dropdown1_2.Height + 2 * Self.LayoutGap
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =5
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    LayoutWrap: =true
                    Visible: =DropdownCalendarType_2.Selected.Value = "Outlook" && showSettings
                    Width: =Parent.Width
                    ZIndex: =5

                    Label3_3 As label:
                        Align: =Align.Center
                        AutoHeight: =true
                        Size: =15
                        Text: |-
                            ="Calendar
                            "
                        ZIndex: =1

                    Dropdown1_2 As dropdown:
                        Default: ="2"
                        Items: =Office365Outlook.CalendarGetTablesV2().value
                        Width: |
                            =200
                        X: =440
                        Y: =205
                        ZIndex: =2

                Label11_1 As label:
                    AlignInContainer: =AlignInContainer.Stretch
                    AutoHeight: =true
                    FontWeight: =FontWeight.Semibold
                    Overflow: =Overflow.Scroll
                    Size: =15
                    Text: =If(DropdownCalendarType_2.Selected.Value = "Serwer Studia", "Here is your schedule from Server Studia", "Here is your calendar view")
                    ZIndex: =6

                Container4 As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =DatePicker2.Height + DatePicker2.BorderThickness
                    LayoutGap: =15
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    LayoutOverflowY: =LayoutOverflow.Scroll
                    Width: =300
                    ZIndex: =7

                    Icon2_6 As icon.ArrowLeft:
                        Height: =40
                        Icon: =Icon.ArrowLeft
                        OnSelect: =Set(varSelectedDateDatePicker, DateAdd(varSelectedDate, -1, TimeUnit.Days))
                        Width: =31
                        ZIndex: =1

                    DatePicker2 As datepicker:
                        DefaultDate: =varSelectedDateDatePicker
                        OnChange: =Set(varSelectedDate, Self.SelectedDate)
                        Width: =160
                        ZIndex: =3

                    Icon1_6 As icon.ArrowRight:
                        Height: =40
                        Icon: =Icon.ArrowRight
                        OnSelect: |-
                            =//(DatePicker1_6.SelectedDate);
                            Set(varSelectedDateDatePicker, DateAdd(varSelectedDate, 1, TimeUnit.Days))
                        Width: =31
                        X: =215
                        ZIndex: =4

                "Gallery2_11 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DelayItemLoading: =true
                    DisplayMode: =DisplayMode.View
                    Height: =562
                    Items: =Sort(Filter(Office365Outlook.V4CalendarGetItems(Dropdown1_1.Selected.id).value, DateValue(startWithTimeZone)=DateValue(varShowDate)),TimeValue(startWithTimeZone))
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =287
                    LayoutMinWidth: =320
                    LoadingSpinner: =LoadingSpinner.Data
                    Selectable: =false
                    ShowScrollbar: =false
                    TemplatePadding: =0
                    TemplateSize: =90
                    Transition: =Transition.Push
                    Visible: =!serwerStudia
                    Width: =(Parent.Width - 20)/2 - 20
                    X: =683
                    Y: =116
                    ZIndex: =8

                    Button1_11 As button:
                        DisabledFill: =RGBA(244, 244, 244, 0.2)
                        DisplayMode: =DisplayMode.Disabled
                        Height: =Parent.TemplateHeight - 16
                        OnSelect: =Select(Parent)
                        RadiusBottomLeft: =60
                        RadiusBottomRight: =60
                        RadiusTopLeft: =60
                        RadiusTopRight: =60
                        Text: =""
                        Width: =Parent.TemplateWidth - 16
                        X: =1
                        Y: =8
                        ZIndex: =1

                    Title2_5 As label:
                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                        Height: =36
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =20
                        Text: =ThisItem.subject
                        VerticalAlign: =VerticalAlign.Top
                        Width: =1
                        Y: =34
                        ZIndex: =2

                    Subtitle2_33 As label:
                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                        Height: =23
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Text: =
                        VerticalAlign: =VerticalAlign.Top
                        Width: =1
                        Y: =40
                        ZIndex: =3

                    NextArrow2_5 As icon.ChevronRight:
                        AccessibleLabel: =Self.Tooltip
                        Color: =RGBA(166, 166, 166, 1)
                        Height: =50
                        Icon: =Icon.ChevronRight
                        OnSelect: =Select(Parent)
                        PaddingBottom: =16
                        PaddingLeft: =16
                        PaddingRight: =16
                        PaddingTop: =16
                        Tooltip: ="View item details"
                        Width: =1
                        Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                        ZIndex: =4

                    Subtitle2_32 As label:
                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                        Height: =36
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =24
                        Text: |-
                            =Text(ThisItem.startWithTimeZone, "hh:mm")&" - "&Text(ThisItem.endWithTimeZone, "hh:mm")
                        VerticalAlign: =VerticalAlign.Top
                        Width: =1
                        Y: =34
                        ZIndex: =6

                "Gallery2_10 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    DelayItemLoading: =true
                    DisplayMode: =DisplayMode.View
                    Height: =557
                    Items: =Sort(Filter('Serwer Studia'.Getuserschedule("json", Text(varSelectedDate, "yyyy-mm-dd")).plan, DateValue(date) = varSelectedDate),hour)
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =300
                    LayoutMinWidth: =320
                    LoadingSpinner: =LoadingSpinner.Data
                    Selectable: =false
                    TemplatePadding: =0
                    TemplateSize: =90
                    Transition: =Transition.Push
                    Visible: =serwerStudia
                    Width: =(Parent.Width - 20)/2 - 20
                    X: =Parent.Width / 2
                    Y: =121
                    ZIndex: =9

                    Button1_10 As button:
                        DisabledFill: =RGBA(244, 244, 244, 0.2)
                        DisplayMode: =DisplayMode.Disabled
                        Height: =Parent.TemplateHeight - 16
                        OnSelect: =Select(Parent)
                        RadiusBottomLeft: =60
                        RadiusBottomRight: =60
                        RadiusTopLeft: =60
                        RadiusTopRight: =60
                        Text: =""
                        Width: =Parent.TemplateWidth - 16
                        X: =8
                        Y: =8
                        ZIndex: =1

                    ClassNameGalleryServerStudia_5 As label:
                        FontWeight: =FontWeight.Semibold
                        Height: =18
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =If(App.Width < 640, 12, App.Width < 100, 16, 30)
                        Text: =Last(Split(ThisItem.skr, "-")).Value
                        Width: =128
                        X: =Parent.X + Parent.TemplateWidth / 2 - Self.Width
                        Y: =11
                        ZIndex: =2

                    ClassTypeGalleryServerStudia_5 As label:
                        Align: =Align.Center
                        AutoHeight: =true
                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =20
                        Text: =ThisItem.type
                        Width: =77
                        X: =ClassNameGalleryServerStudia_5.X + ClassNameGalleryServerStudia_5.Width + 5
                        Y: =19
                        ZIndex: =6

                    Group1_5 As group:
                        Height: =5
                        Width: =5
                        X: =60
                        Y: =60
                        ZIndex: =9

                        Subtitle2_29 As label:
                            Align: =Align.Center
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =34
                            OnSelect: =Select(Parent)
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =20
                            Text: |-
                                =DateAdd(TimeValue(ThisItem.hour&":00"),15,TimeUnit.Minutes)&" - "&DateAdd(TimeValue(ThisItem.hour&":00"),ThisItem.length,TimeUnit.Hours)
                            Width: =165
                            X: =Parent.X + Parent.TemplateWidth / 2 - Self.Width
                            Y: =55
                            ZIndex: =7

                        Subtitle2_31 As label:
                            Align: =Align.Center
                            AutoHeight: =true
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =34
                            OnSelect: =Select(Parent)
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =20
                            Text: |-
                                ="sala: "
                                &
                                If (
                                    EndsWith(Last(Split(ThisItem.room,"-")).Value, "AR"),
                                    Last(FirstN(Split(ThisItem.room,"-"), CountRows(Split(ThisItem.room,"-")) - 1)).Value & "-" & Last(Split(ThisItem.room,"-")).Value,
                                    Last(Split(ThisItem.room,"-")).Value
                                )
                            Width: =172
                            X: =Subtitle2_29.X + Subtitle2_29.Width
                            Y: =55
                            ZIndex: =8

        ContainerRoomSelection As groupContainer.horizontalAutoLayoutContainer:
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutGap: =10
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowY: =LayoutOverflow.Scroll
            LayoutWrap: =true
            Visible: =varRoomSelection
            ZIndex: =3

            ContainerFacultyMap As groupContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =3
                Height: =Parent.Height - 20
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                Visible: =varShowFacultyMap
                Width: =942
                X: =10
                Y: =10
                ZIndex: =1

                Image2_6 As image:
                    Height: =Parent.Height
                    Image: ='Screenshot 2024-03-17 at 22.21.45'
                    ImagePosition: =ImagePosition.Stretch
                    Width: =Parent.Width
                    ZIndex: =1

                room103_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom103,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: =Parent.Height * 41 / 668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "103",
                            "X"
                        )
                    Width: =Parent.Width * 36 / 1010
                    X: =Parent.Width * 114 / 1010
                    Y: =Parent.Height*357/668
                    ZIndex: =2

                room104_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom104,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: =Parent.Height * 41 / 668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "104",
                            "X"
                        )
                    Width: =Parent.Width * 35 / 1010
                    X: =Parent.Width * 150 / 1010
                    Y: =Parent.Height * 357 / 668
                    ZIndex: =3

                room102_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom102,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: |-
                        =//40
                        (Parent.Height * 41)/668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "102",
                            "X"
                        )
                    Width: |-
                        =//34
                        Parent.Width * 34 / 1010
                    X: |-
                        =//80
                        (Parent.Width * 80)/1010
                    Y: |-
                        =//358
                        (Parent.Height * 357)/668
                    ZIndex: =4

                room161_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom161,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: |-
                        =//118
                        (Parent.Height * 118)/668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "161",
                            "X"
                        )
                    Width: |-
                        =//91
                        (Parent.Width * 91)/1010 
                    X: |-
                        =(Parent.Width * 169)/1010
                        //169
                    Y: |-
                        =//176
                        (Parent.Height * 176)/668
                    ZIndex: =11

                room107_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom107,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: =Parent.Height * 39 / 668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "107",
                            "X"
                        )
                    Width: =Parent.Width * 37 / 1010
                    X: =Parent.Width * 276 / 1010
                    Y: =Parent.Height * 357/668
                    ZIndex: =12

                room108_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom108,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: =Parent.Height * 39 / 668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "108",
                            "X"
                        )
                    Width: =Parent.Width * 52 / 1010
                    X: =Parent.Width * 313 / 1010
                    Y: =Parent.Height*357/668
                    ZIndex: =13

                room106_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom106,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: =Parent.Height * 39 / 668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "106",
                            "X"
                        )
                    Width: =Parent.Width * 34 / 1010
                    X: =Parent.Width * 242 / 1010
                    Y: =Parent.Height * 357 / 668
                    ZIndex: =14

                room105_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom161,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: =Parent.Height * 83 / 668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "105",
                            "X"
                        )
                    Width: =Parent.Width * 74 / 1010
                    X: =Parent.Width * 177 / 1010
                    Y: =Parent.Height * 427 / 668
                    ZIndex: =15

                room116_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom116,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: =Parent.Height * 40 / 668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "116",
                            "X"
                        )
                    Width: =Parent.Width * 52 / 1010
                    X: =Parent.Width * 602/1010
                    Y: =Parent.Height * 357/668
                    ZIndex: =16

                room117_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom117,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: =Parent.Height * 40 / 668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "117",
                            "X"
                        )
                    Width: =Parent.Width * 34/1010
                    X: =Parent.Width * 654/1010
                    Y: =Parent.Height * 357/668
                    ZIndex: =17

                room133_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom133,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: =Parent.Height * 118/668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "133",
                            "X"
                        )
                    Width: =Parent.Width*91/1010
                    X: =Parent.Width * 672/1010
                    Y: =Parent.Height * 176/668
                    ZIndex: =18

                "'room116-AR_6' As button":
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom161,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: =Parent.Height * 83/668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "116-AR",
                            "X"
                        )
                    Width: =Parent.Width * 74/1010
                    X: =Parent.Width * 680/1010
                    Y: =Parent.Height*427/668
                    ZIndex: =19

                room120_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom117,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: =Parent.Height*42/668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "120",
                            "X"
                        )
                    Width: =Parent.Width*37/1010
                    X: =Parent.Width * 781/1010
                    Y: =Parent.Height*356/668
                    ZIndex: =20

                room121_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom117,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: =Parent.Height*42/668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "121",
                            "X"
                        )
                    Width: =Parent.Width * 34/1010
                    X: =Parent.Width*818/1010
                    Y: =Parent.Height*356/668
                    ZIndex: =21

                room122_6 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =1
                    Color: =If (SelectedRoom = Self, Color.Black, Color.White)
                    DisabledColor: =Self.Color
                    DisabledFill: |-
                        =If(
                            Self.Fill = Color.Red,
                            Color.Red
                        )
                    DisplayMode: =If(SelectedRoom = Self || Self.Fill = Color.Green, DisplayMode.Edit, DisplayMode.Disabled)
                    Fill: |-
                        =If(
                            CountRows(
                                Filter(
                                    ScheduleRoom117,
                                    With(
                                        {
                                            classStart: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + 0.25,
                                                TimeUnit.Hours
                                            ),
                                            classEnd: DateAdd(
                                                DateValue(
                                                    date,
                                                    "en"
                                                ),
                                                hour + Value(length),
                                                TimeUnit.Hours
                                            )
                                        },
                                        Or(
                                            And(
                                                classStart <= EndDateTime,
                                                classStart >= StartDateTime
                                            ),
                                            And(
                                                classEnd <= EndDateTime,
                                                classEnd >= StartDateTime
                                            ),
                                            And(
                                                StartDateTime <= classEnd,
                                                StartDateTime >= classStart
                                            )
                                        )
                                    )
                                )
                            ) = 0,
                            If (SelectedRoom = Self,
                                Color.Yellow,
                                Color.Green
                            ),
                            Color.Red
                        )
                    FocusedBorderThickness: =1
                    Height: =Parent.Height*61/668
                    HoverColor: =ColorFade(Self.Color, 15%)
                    HoverFill: =ColorFade(Self.Fill, 18%)
                    OnSelect: |-
                        =UpdateContext({SelectedRoom: Self})
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =9
                    Text: |-
                        =If(
                            Self.Fill = Color.Green || Self.Fill = Color.Yellow,
                            "122",
                            "X"
                        )
                    Width: =Parent.Width*36/1010
                    X: =Parent.Width * 852/1010
                    Y: =Parent.Height*337/668
                    ZIndex: =22

            ContainerProperties As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Height: =Parent.Height
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =10
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Visible: =varShowProperties
                Width: =Parent.Width
                ZIndex: =3

                Icon7 As icon.Cancel:
                    AlignInContainer: =AlignInContainer.End
                    Height: =32
                    Icon: =Icon.Cancel
                    LayoutMinWidth: =32
                    OnSelect: |-
                        =UpdateContext({varRoomSelection: false});
                        UpdateContext({varShowMainScreen: true})
                    PaddingLeft: =20
                    ZIndex: =1

                Container10 As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =100
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =4
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =5
                    PaddingLeft: =5
                    PaddingRight: =5
                    PaddingTop: =5
                    ZIndex: =2

                    Label12 As label:
                        Size: =15
                        Text: |-
                            ="Selected room:"
                        ZIndex: =1

                    Button4 As button:
                        DisplayMode: =DisplayMode.View
                        Fill: =WEITI_Szafirowy
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: =SelectedRoom.Text
                        ZIndex: =2

                Container10_2 As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =100
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =4
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =5
                    PaddingLeft: =5
                    PaddingRight: =5
                    PaddingTop: =5
                    ZIndex: =3

                    Label12_1 As label:
                        Text: |-
                            ="Selected date:"
                        ZIndex: =1

                    Button4_1 As button:
                        DisplayMode: =DisplayMode.View
                        Text: ="Selected"
                        Visible: =false
                        ZIndex: =2

                    DatePicker1 As datepicker:
                        AlignInContainer: =AlignInContainer.Stretch
                        BorderThickness: =0
                        Color: =RGBA(255, 255, 255, 1)
                        Fill: =WEITI_Szafirowy
                        IconBackground: =WEITI_Grafitowy
                        LayoutMinWidth: =160
                        OnChange: |
                            =Set(DateSelected, Self.SelectedDate);
                            If (
                                Self.SelectedDate < Today(),
                                Reset(Self);
                                Notify("Error. Please select future Date.", NotificationType.Error),
                            
                                Set(StartTimeMinutes, Hour(StartDateTime)*60 + Minute(StartDateTime));
                                Set(EndTimeMinutes, Hour(EndDateTime)*60 + Minute(EndDateTime));
                            
                                Set(StartDateTime, DateAdd(DateSelected, StartTimeMinutes, TimeUnit.Minutes));
                                Set(EndDateTime, DateAdd(DateSelected, EndTimeMinutes, TimeUnit.Minutes));
                            
                                Set(StartDateTimeUTC, Text(DateAdd(StartDateTime, TimeZoneOffset(), TimeUnit.Minutes), "[$-en-US]yyyy-mm-ddThh:mm") & ":00.000Z");
                                Set(EndDateTimeUTC, Text(DateAdd(EndDateTime, TimeZoneOffset(), TimeUnit.Minutes), "[$-en-US]yyyy-mm-ddThh:mm") & ":00.000Z");
                            
                                Concurrent(
                                    ClearCollect(ScheduleRoom102, 'Serwer Studia'.Getclassesfromroom("1030-ETI-102", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom103, 'Serwer Studia'.Getclassesfromroom("1030-ETI-103", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom104, 'Serwer Studia'.Getclassesfromroom("1030-ETI-104", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom105, 'Serwer Studia'.Getclassesfromroom("1030-ETI-105-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                            
                                Concurrent(
                                    ClearCollect(ScheduleRoom106, 'Serwer Studia'.Getclassesfromroom("1030-ETI-106", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom107, 'Serwer Studia'.Getclassesfromroom("1030-ETI-107", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom161, 'Serwer Studia'.Getclassesfromroom("1030-ETI-161", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom108, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                            
                                Concurrent(
                                    ClearCollect(ScheduleRoom116, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom117, 'Serwer Studia'.Getclassesfromroom("1030-ETI-117", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom116AR, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom133, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                            
                                Concurrent(
                                    ClearCollect(ScheduleRoom120, 'Serwer Studia'.Getclassesfromroom("1030-ETI-120", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom121, 'Serwer Studia'.Getclassesfromroom("1030-ETI-121", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                                    ClearCollect(ScheduleRoom122, 'Serwer Studia'.Getclassesfromroom("1030-ETI-122", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                                );
                            )
                        PaddingLeft: =Self.Width - Len("23/24/2321") * 23 + 20
                        PaddingTop: =5
                        Size: =15
                        StartOfWeek: =StartOfWeek.Monday
                        ZIndex: =3

                Container10_3 As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =100
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =4
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =5
                    PaddingLeft: =5
                    PaddingRight: =5
                    PaddingTop: =5
                    ZIndex: =4

                    Label12_2 As label:
                        Text: |-
                            ="Selected date:"
                        ZIndex: =1

                    Button4_2 As button:
                        OnSelect: |-
                            =If (
                                App.Width < 300,
                            
                                UpdateContext({varShowFacultyMap:false});
                                UpdateContext({varShowTimeSelection:true});
                                UpdateContext({varShowProperties:false}),
                            
                                UpdateContext({varShowTimeSelection:true});
                                UpdateContext({varShowProperties:false})
                            )
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: =Text(StartDateTime, DateTimeFormat.ShortTime) & " - " & Text(EndDateTime, DateTimeFormat.ShortTime)
                        ZIndex: =2

            ContainerTimeSelection As groupContainer.verticalAutoLayoutContainer:
                Fill: =RGBA(244, 244, 244, 1)
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =5
                LayoutMinHeight: =100
                LayoutMinWidth: =300
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowY: =LayoutOverflow.Scroll
                Visible: =varShowTimeSelection
                ZIndex: =4

                Container13 As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =Label4_18.Height
                    LayoutMinHeight: =100
                    LayoutMinWidth: |
                        =300
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    ZIndex: =1

                    Rectangle1_12 As rectangle:
                        Height: =50
                        Visible: =false
                        Width: =Parent.Width
                        ZIndex: =1

                    Label4_18 As label:
                        Align: =Align.Center
                        Fill: =WEITI_Szafirowy
                        Height: =44
                        Size: =20
                        Text: ="SELECT TIME"
                        Width: =Parent.Width
                        ZIndex: =2

                    Icon3_4 As icon.Cancel:
                        Color: =RGBA(255, 255, 255, 1)
                        Height: =Label4_18.Height
                        Icon: =Icon.Cancel
                        OnSelect: =Set(ShowDatePicker, false)
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        Width: =44
                        ZIndex: =3

                Container15 As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    Height: =Parent.LayoutGap + Container16.Height
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =80
                    LayoutMinWidth: =100
                    LayoutMode: =LayoutMode.Auto
                    LayoutWrap: =true
                    PaddingBottom: =5
                    PaddingLeft: =10
                    PaddingRight: =10
                    PaddingTop: =5
                    ZIndex: =2

                    Container16 As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.Center
                        DropShadow: =DropShadow.None
                        Height: =Label6_6.Height+DropdownStartTime_3.Height+2*DropdownStartTime_3.BorderThickness
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =100
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =4
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: =30
                        ZIndex: =1

                        Label6_6 As label:
                            FontWeight: =FontWeight.Semibold
                            Text: ="Start"
                            Width: =158
                            X: =54
                            Y: =76
                            ZIndex: =1

                        DropdownStartTime_3 As dropdown:
                            BorderColor: =If(ButtonSaveTime_1.DisplayMode = DisplayMode.Edit, RGBA(120, 120, 120, 1), Color.Red)
                            ChevronBackground: =RGBA(62, 96, 170, 0)
                            ChevronDisabledBackground: =RGBA(159, 167, 165, 1)
                            ChevronDisabledFill: =ColorFade(RGBA(47, 41, 43, 1), 70%)
                            ChevronFill: =RGBA(18, 107, 240, 1)
                            Default: =If(ResetTrue, LookUp(Times, Text = Lower(Text(StartDateTime, DateTimeFormat.ShortTime))).Text)
                            Items: =Times
                            Width: =Parent.Width - Self.BorderThickness*2
                            X: =ButtonSaveTime_1.X
                            Y: =40
                            ZIndex: =2

                    Container16_1 As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        Height: =Label6_7.Height+DropdownEndTime_3.Height + 2*DropdownEndTime_3.BorderThickness
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =100
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =4
                        Width: =30
                        ZIndex: =2

                        Label6_7 As label:
                            FontWeight: =FontWeight.Semibold
                            Text: ="End"
                            Width: =158
                            X: =232
                            Y: =76
                            ZIndex: =1

                        DropdownEndTime_3 As dropdown:
                            BorderColor: =If(ButtonSaveTime_1.DisplayMode = DisplayMode.Edit, RGBA(120, 120, 120, 1), Color.Red)
                            ChevronBackground: =RGBA(62, 96, 170, 0)
                            ChevronDisabledBackground: =RGBA(159, 167, 165, 1)
                            ChevronDisabledFill: =ColorFade(RGBA(47, 41, 43, 1), 70%)
                            ChevronFill: =RGBA(18, 107, 240, 1)
                            Default: =If(IsBlank(DurationGallery_1.Selected) && IsBlank(DurationSelection) || ResetTrue, LookUp(Times, Text = Lower(Text(EndDateTime, DateTimeFormat.ShortTime))).Text, !IsBlank(DurationSelection), LookUp(Times, Minutes = Mod(DropdownStartTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes' + DurationGallery_1.Selected.Minutes, 1440)).Text)
                            Items: =Times
                            Width: =Parent.Width - Self.BorderThickness * 2
                            X: =232
                            Y: =40
                            ZIndex: =2

                "DurationGallery_3 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DelayItemLoading: =true
                    FillPortions: =4
                    Height: =355
                    Items: =Durations
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =350
                    LayoutMinWidth: =320
                    LoadingSpinner: =LoadingSpinner.Data
                    ShowScrollbar: =false
                    TemplatePadding: =15
                    TemplateSize: =90
                    Width: =361
                    WrapCount: =2
                    X: =40
                    Y: =190
                    ZIndex: =3

                    Button5_4 As button:
                        BorderColor: =RGBA(18, 107, 240, 1)
                        Color: =Self.BorderColor
                        Fill: =If(ThisItem.Minutes = DurationSelection.Minutes, RGBA(18, 107, 240, .2), RGBA(0, 0, 0, 0))
                        Height: =Parent.TemplateHeight
                        OnSelect: |-
                            =Select(Parent);
                            If(IsBlank(DurationSelection) || ThisItem.Time <> DurationSelection.Time, Set(DurationSelection, ThisItem), Set(DurationSelection, Blank()));
                            UpdateContext({ResetTrue: false})
                        Text: ="+ " & ThisItem.Time
                        Width: =Parent.TemplateWidth
                        ZIndex: =3

                Container17 As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =60
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    PaddingBottom: =30
                    PaddingLeft: =30
                    PaddingRight: =30
                    PaddingTop: =30
                    ZIndex: =5

                    ButtonSaveTime_3 As button:
                        Height: =Parent.Height
                        OnSelect: |
                            =Set(StartDateTime, DateAdd(DateSelected, DropdownStartTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes', TimeUnit.Minutes));
                            Set(EndDateTime, DateAdd(StartDateTime, If(DropdownStartTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes' >= DropdownEndTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes', DropdownEndTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes' + 1440 - DropdownStartTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes', DropdownEndTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes' - DropdownStartTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes'), TimeUnit.Minutes));
                            
                            Set(StartDateTimeUTC, Text(DateAdd(StartDateTime, TimeZoneOffset(), TimeUnit.Minutes), "[$-en-US]yyyy-mm-ddThh:mm") & ":00.000Z");
                            Set(EndDateTimeUTC, Text(DateAdd(EndDateTime, TimeZoneOffset(), TimeUnit.Minutes), "[$-en-US]yyyy-mm-ddThh:mm") & ":00.000Z");
                            
                            Set(ShowTimePicker, false)
                        PaddingBottom: =10
                        Text: ="SAVE"
                        Width: =Parent.Width
                        ZIndex: =1

        TextInput1_2 As text:
            Align: =Align.Center
            BorderThickness: =0
            Default: ="Jan Halemba (305979)"
            DisabledFill: |-
                =ColorValue("#FFFFFF")
            DisplayMode: =DisplayMode.Disabled
            Height: =20
            RadiusBottomLeft: =10
            RadiusBottomRight: =10
            RadiusTopLeft: =10
            RadiusTopRight: =10
            Size: =9
            Width: =Parent.Width
            ZIndex: =4

    Container6 As groupContainer:
        Height: =App.Height
        Visible: =ShowLoading
        Width: =App.Width
        ZIndex: =4

        Rectangle2_12 As rectangle:
            BorderColor: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Parent.Height
            Width: =Parent.Width
            ZIndex: =1

        Spinner1_12 As Spinner:
            BasePaletteColor: =
            DisplayMode: =DisplayMode.Edit
            FontColor: =
            Height: =341
            SpinnerSize: ='Spinner.SpinnerSize'.Huge
            Visible: =true
            Width: =341
            X: =Parent.Width / 2 - Self.Width / 2
            Y: =Parent.Height / 2 - Self.Height / 2
            ZIndex: =2

        Label8_12 As label:
            Align: =Align.Center
            Height: =65
            Size: =30
            Text: ="Loading... "&Text(LoadingDone)
            Width: =341
            X: =Spinner1_12.X
            Y: =Spinner1_12.Y + Spinner1_12.Height
            ZIndex: =3

    DateSelectionPopup_1 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.Regular
        Height: =Parent.Height - 90
        RadiusBottomLeft: =10
        RadiusBottomRight: =10
        RadiusTopLeft: =10
        RadiusTopRight: =10
        Visible: =false
        Width: =(Parent.Width - (20 * 2)) / 3
        X: =RoomSelectionPopup_1.Width + 40
        Y: =60
        ZIndex: =5

        Button3_9 As button:
            DisplayMode: =DisplayMode.Disabled
            Height: =Parent.Height
            Text: =""
            Width: =Parent.Width
            X: =
            ZIndex: =1

        Rectangle1_5 As rectangle:
            Fill: =RGBA(71, 158, 245, 1)
            Height: =26
            Width: =442
            Y: =65
            ZIndex: =2

        Rectangle1_4 As rectangle:
            Height: =65
            Width: =442
            ZIndex: =3

        Icon3_6 As icon.Cancel:
            Color: =RGBA(255, 255, 255, 1)
            Height: =44
            Icon: =Icon.Cancel
            OnSelect: =Set(ShowDatePicker, false)
            Width: =44
            X: =10
            Y: =10
            ZIndex: =4

        Button2_20 As button:
            OnSelect: =
            Text: =Text(StartDateTime, DateTimeFormat.ShortTime) & " - " & Text(EndDateTime, DateTimeFormat.ShortTime)
            Width: =319
            X: =123
            Y: =196
            ZIndex: =5

        Rectangle1_6 As rectangle:
            Height: =105
            Width: =442
            Y: =91
            ZIndex: =6

        "WeekdayGallery_1 As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            Height: =40
            Items: =["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"]
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =MonthDayGallery_1.TemplateWidth
            Width: =361
            X: =40
            Y: =251
            ZIndex: =7

            Title1_1 As label:
                Align: =Align.Center
                Height: =27
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.Value
                VerticalAlign: =VerticalAlign.Top
                Width: =30
                X: =Parent.TemplateWidth / 2 - Self.Width / 2
                Y: =Parent.TemplateHeight / 2 - Self.Height / 2
                ZIndex: =2

        Label4_7 As label:
            Align: =Align.Center
            Height: =26
            Text: =Text(DateSelected, "[$-en-US]dddd")
            Width: =442
            Y: =65
            ZIndex: =8

        "MonthDayGallery_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            Height: =297
            Items: =[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =50
            Width: =361
            WrapCount: =7
            X: =40
            Y: =276
            ZIndex: =9

            Circle3_2 As circle:
                Fill: =If(DateAdd(firstDayInView, ThisItem.Value) = DateSelected && DateAdd(firstDayInView, ThisItem.Value) >= Today() && DateAdd(firstDayInView, ThisItem.Value) >= firstDayOfMonth, RGBA(121, 121, 121, 1), RGBA(0,0,0,0))
                Height: =33
                Visible: =DateAdd(firstDayInView, ThisItem.Value, TimeUnit.Days) = DateSelected && Title3_1.Visible
                Width: =33
                X: =Title3_1.X
                Y: =Title3_1.Y
                ZIndex: =1

            Title3_1 As label:
                Align: =Align.Center
                Color: =If(DateAdd(firstDayInView,ThisItem.Value) < Today(), ColorFade(RGBA(47,41,43,1), 80%), RGBA(47,41,43,1))
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =33
                OnSelect: |-
                    =If (
                        DateAdd(
                            firstDayInView,
                            ThisItem.Value
                        ) >= Today(),
                        Select(Parent);
                        Set(
                            DateSelected,
                            DateAdd(
                                firstDayInView,
                                ThisItem.Value,
                                TimeUnit.Days
                            )
                        )
                    )
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Day(DateAdd(firstDayInView,ThisItem.Value,TimeUnit.Days))
                Visible: =If(DateAdd(firstDayInView,ThisItem.Value,TimeUnit.Days) < firstDayOfMonth || DateAdd(firstDayInView,ThisItem.Value,TimeUnit.Days) > LastDayOfMonth,false,true)
                Width: =33
                X: =Parent.TemplateWidth / 2 - Self.Width / 2
                Y: =Parent.TemplateHeight / 2 - Self.Height / 2
                ZIndex: =2

        Label4_8 As label:
            Align: =Align.Center
            Height: =32
            Text: =Text(DateSelected, "[$-en-US]mmmm")
            Width: =442
            Y: =91
            ZIndex: =10

        Label4_9 As label:
            Align: =Align.Center
            Height: =49
            Size: =40
            Text: =Text(DateSelected, "[$-en-US]dd")
            Width: =442
            Y: =119
            ZIndex: =11

        Label4_10 As label:
            Align: =Align.Center
            Height: =28
            Text: =Text(DateSelected, "[$-en-US]yyyy")
            Width: =442
            Y: =168
            ZIndex: =12

        Button2_21 As button:
            Height: =55
            OnSelect: |
                =Set(DateSpinner, true);
                Set(StartTimeMinutes, Hour(StartDateTime)*60 + Minute(StartDateTime));
                Set(EndTimeMinutes, Hour(EndDateTime)*60 + Minute(EndDateTime));
                
                Set(StartDateTime, DateAdd(DateSelected, StartTimeMinutes, TimeUnit.Minutes));
                Set(EndDateTime, DateAdd(DateSelected, EndTimeMinutes, TimeUnit.Minutes));
                
                Set(StartDateTimeUTC, Text(DateAdd(StartDateTime, TimeZoneOffset(), TimeUnit.Minutes), "[$-en-US]yyyy-mm-ddThh:mm") & ":00.000Z");
                Set(EndDateTimeUTC, Text(DateAdd(EndDateTime, TimeZoneOffset(), TimeUnit.Minutes), "[$-en-US]yyyy-mm-ddThh:mm") & ":00.000Z");
                
                Concurrent(
                    ClearCollect(ScheduleRoom102, 'Serwer Studia'.Getclassesfromroom("1030-ETI-102", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom103, 'Serwer Studia'.Getclassesfromroom("1030-ETI-103", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom104, 'Serwer Studia'.Getclassesfromroom("1030-ETI-104", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom105, 'Serwer Studia'.Getclassesfromroom("1030-ETI-105-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Concurrent(
                    ClearCollect(ScheduleRoom106, 'Serwer Studia'.Getclassesfromroom("1030-ETI-106", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom107, 'Serwer Studia'.Getclassesfromroom("1030-ETI-107", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom161, 'Serwer Studia'.Getclassesfromroom("1030-ETI-161", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom108, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Concurrent(
                    ClearCollect(ScheduleRoom116, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom117, 'Serwer Studia'.Getclassesfromroom("1030-ETI-117", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom116AR, 'Serwer Studia'.Getclassesfromroom("1030-ETI-116-AR", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom133, 'Serwer Studia'.Getclassesfromroom("1030-ETI-108", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Concurrent(
                    ClearCollect(ScheduleRoom120, 'Serwer Studia'.Getclassesfromroom("1030-ETI-120", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom121, 'Serwer Studia'.Getclassesfromroom("1030-ETI-121", {date:Text(DateSelected, "yyyy-mm-dd")}).plan),
                    ClearCollect(ScheduleRoom122, 'Serwer Studia'.Getclassesfromroom("1030-ETI-122", {date:Text(DateSelected, "yyyy-mm-dd")}).plan)
                );
                
                Set(DateSpinner, false);
                UpdateContext({SelectedRoom: Blank()});
                Set(ShowDatePicker, false)
            Text: ="SAVE"
            Width: =336
            X: =49
            Y: =598
            ZIndex: =13

        Label4_6 As label:
            Align: =Align.Center
            Height: =44
            Size: =20
            Text: ="SELECT DATE"
            Width: =281
            X: =80
            Y: =10
            ZIndex: =14

        Icon4_1 As icon.ArrowLeft:
            Height: =35
            Icon: =Icon.ArrowLeft
            OnSelect: |-
                =If(DateAdd(firstDayOfMonth, -1, TimeUnit.Days) >= Today(),
                    Set(firstDayOfMonth, DateAdd(firstDayOfMonth, -1, TimeUnit.Months));
                    Set(firstDayInView, DateAdd(firstDayOfMonth, -(Mod(Weekday(firstDayOfMonth)-2,7)+1), TimeUnit.Days));
                    Set(LastDayOfMonth, DateAdd(DateAdd(firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                )
            Width: =35
            X: =54
            Y: =204
            ZIndex: =15

        Icon5_1 As icon.ArrowRight:
            Height: =35
            Icon: =Icon.ArrowRight
            OnSelect: |-
                =Set(firstDayOfMonth, DateAdd(firstDayOfMonth, 1, TimeUnit.Months));
                Set(firstDayInView, DateAdd(firstDayOfMonth, -(Mod(Weekday(firstDayOfMonth)-2, 7)+1),TimeUnit.Days));
                Set(LastDayOfMonth, DateAdd(DateAdd(firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
            Width: =35
            X: =355
            Y: =204
            ZIndex: =16

        Label5_1 As label:
            Align: =Align.Center
            Text: =Text(firstDayOfMonth, "[$-en-US]mmmm yyyy")
            X: =147
            Y: =201
            ZIndex: =17

        Spinner_1 As group:
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =21

            Rectangle2_7 As rectangle:
                BorderColor: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(255, 255, 255, 1)
                Height: =678
                Visible: =DateSpinner
                Width: =442
                ZIndex: =18

            Spinner1_7 As Spinner:
                BasePaletteColor: =
                DisplayMode: =DisplayMode.Edit
                FontColor: =
                Height: =200
                Visible: =DateSpinner
                Width: =200
                X: =122
                Y: =226
                ZIndex: =19

            Label8_7 As label:
                Align: =Align.Center
                Text: ="Syncing with Server Studia..."
                Visible: =DateSpinner
                Width: =442
                Y: =377
                ZIndex: =20

    TimeSelectionPopup_1 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.Regular
        Height: =Parent.Height - 90
        RadiusBottomLeft: =10
        RadiusBottomRight: =10
        RadiusTopLeft: =10
        RadiusTopRight: =10
        Visible: =false
        Width: =(Parent.Width - (20 * 2)) / 3
        X: =RoomSelectionPopup_1.Width + 40
        Y: =60
        ZIndex: =6

        Button3_10 As button:
            DisplayMode: =DisplayMode.Disabled
            Height: =Parent.Height
            Text: =""
            Width: =Parent.Width
            X: =
            ZIndex: =1

        Rectangle1_7 As rectangle:
            Height: =65
            Width: =442
            ZIndex: =3

        Icon3_7 As icon.Cancel:
            Color: =RGBA(255, 255, 255, 1)
            Height: =44
            Icon: =Icon.Cancel
            OnSelect: =Set(ShowTimePicker, false)
            Width: =44
            X: =10
            Y: =10
            ZIndex: =4

        ButtonSaveTime_1 As button:
            Height: =55
            OnSelect: |
                =Set(StartDateTime, DateAdd(DateSelected, DropdownStartTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes', TimeUnit.Minutes));
                Set(EndDateTime, DateAdd(StartDateTime, If(DropdownStartTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes' >= DropdownEndTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes', DropdownEndTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes' + 1440 - DropdownStartTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes', DropdownEndTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes' - DropdownStartTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes'), TimeUnit.Minutes));
                
                Set(StartDateTimeUTC, Text(DateAdd(StartDateTime, TimeZoneOffset(), TimeUnit.Minutes), "[$-en-US]yyyy-mm-ddThh:mm") & ":00.000Z");
                Set(EndDateTimeUTC, Text(DateAdd(EndDateTime, TimeZoneOffset(), TimeUnit.Minutes), "[$-en-US]yyyy-mm-ddThh:mm") & ":00.000Z");
                
                Set(ShowTimePicker, false)
            Text: ="SAVE"
            Width: =336
            X: =54
            Y: =593
            ZIndex: =13

        Label4_11 As label:
            Align: =Align.Center
            Height: =44
            Size: =20
            Text: ="SELECT DATE"
            Width: =281
            X: =80
            Y: =10
            ZIndex: =14

        DropdownStartTime_1 As dropdown:
            BorderColor: =If(ButtonSaveTime_1.DisplayMode = DisplayMode.Edit, RGBA(120, 120, 120, 1), Color.Red)
            ChevronBackground: =RGBA(62, 96, 170, 0)
            ChevronDisabledBackground: =RGBA(159, 167, 165, 1)
            ChevronDisabledFill: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            ChevronFill: =RGBA(18, 107, 240, 1)
            Default: =If(ResetTrue, LookUp(Times, Text = Lower(Text(StartDateTime, DateTimeFormat.ShortTime))).Text)
            Items: =Times
            Width: =ButtonSaveTime_1.Width / 2 - 10
            X: =ButtonSaveTime_1.X
            Y: =116
            ZIndex: =15

        Label6_2 As label:
            FontWeight: =FontWeight.Semibold
            Text: ="Start"
            Width: =158
            X: =54
            Y: =76
            ZIndex: =17

        Label6_3 As label:
            FontWeight: =FontWeight.Semibold
            Text: ="End"
            Width: =158
            X: =232
            Y: =76
            ZIndex: =18

        DropdownEndTime_1 As dropdown:
            BorderColor: =If(ButtonSaveTime_1.DisplayMode = DisplayMode.Edit, RGBA(120, 120, 120, 1), Color.Red)
            ChevronBackground: =RGBA(62, 96, 170, 0)
            ChevronDisabledBackground: =RGBA(159, 167, 165, 1)
            ChevronDisabledFill: =ColorFade(RGBA(47, 41, 43, 1), 70%)
            ChevronFill: =RGBA(18, 107, 240, 1)
            Default: =If(IsBlank(DurationGallery_1.Selected) && IsBlank(DurationSelection) || ResetTrue, LookUp(Times, Text = Lower(Text(EndDateTime, DateTimeFormat.ShortTime))).Text, !IsBlank(DurationSelection), LookUp(Times, Minutes = Mod(DropdownStartTime_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BMinutes' + DurationGallery_1.Selected.Minutes, 1440)).Text)
            Items: =Times
            Width: =ButtonSaveTime_1.Width / 2 - 10
            X: =232
            Y: =116
            ZIndex: =19

        "DurationGallery_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            Height: =355
            Items: =Durations
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            ShowScrollbar: =false
            TemplatePadding: =15
            TemplateSize: =90
            Width: =361
            WrapCount: =2
            X: =40
            Y: =190
            ZIndex: =20

            Button5_2 As button:
                BorderColor: =RGBA(18, 107, 240, 1)
                Color: =Self.BorderColor
                Fill: =If(ThisItem.Minutes = DurationSelection.Minutes, RGBA(18, 107, 240, .2), RGBA(0, 0, 0, 0))
                Height: =Parent.TemplateHeight
                OnSelect: |-
                    =Select(Parent);
                    If(IsBlank(DurationSelection) || ThisItem.Time <> DurationSelection.Time, Set(DurationSelection, ThisItem), Set(DurationSelection, Blank()));
                    UpdateContext({ResetTrue: false})
                Text: ="+ " & ThisItem.Time
                Width: =Parent.TemplateWidth
                ZIndex: =3

